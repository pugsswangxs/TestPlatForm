"use strict";(self["webpackChunkapi_test_platform"]=self["webpackChunkapi_test_platform"]||[]).push([[999],{3999:function(e,t,a){a.d(t,{A:function(){return q}});a(4114);var l=a(6768),s=a(4232);const d={class:"edit_box"},o={key:2,class:"file_box"},n={class:"add_script_box"},u={class:"add_script_box"},i={class:"add_script_box"},r={class:"add_script_box"},c={class:"add_script_box"},p={class:"add_script_box"},_={class:"add_script_box"},b={class:"add_script_box"},m={class:"add_script_box"},k={class:"add_script_box"},h={class:"add_script_box"},f={class:"add_script_box"},g={class:"add_script_box"},y={class:"add_script_box"},F={key:0,class:"result_test"},v={style:{"text-align":"right","margin-bottom":"15px"}};function C(e,t,a,C,x,V){const w=(0,l.g2)("el-divider"),E=(0,l.g2)("el-option"),W=(0,l.g2)("el-select"),D=(0,l.g2)("el-input"),L=(0,l.g2)("el-col"),T=(0,l.g2)("el-button"),X=(0,l.g2)("el-row"),q=(0,l.g2)("CodeEdit"),U=(0,l.g2)("el-tab-pane"),R=(0,l.g2)("el-radio"),I=(0,l.g2)("el-radio-group"),j=(0,l.g2)("el-upload"),A=(0,l.g2)("el-table-column"),S=(0,l.g2)("el-table"),N=(0,l.g2)("el-scrollbar"),P=(0,l.g2)("el-tabs"),O=(0,l.g2)("el-tooltip"),B=(0,l.g2)("CaseResult");return(0,l.uX)(),(0,l.CE)("div",d,[(0,l.bF)(w,{"content-position":"left"},{default:(0,l.k6)((()=>t[27]||(t[27]=[(0,l.Lk)("b",null,"Api信息",-1)]))),_:1,__:[27]}),(0,l.bF)(X,null,{default:(0,l.k6)((()=>[(0,l.bF)(L,{span:18},{default:(0,l.k6)((()=>[(0,l.bF)(D,{modelValue:x.url,"onUpdate:modelValue":t[1]||(t[1]=e=>x.url=e),placeholder:"请输入接口地址",class:"input-with-select"},{prepend:(0,l.k6)((()=>[(0,l.bF)(W,{modelValue:x.method,"onUpdate:modelValue":t[0]||(t[0]=e=>x.method=e),placeholder:"Select",style:{width:"115px"}},{default:(0,l.k6)((()=>[(0,l.bF)(E,{label:"GET",value:"get"}),(0,l.bF)(E,{label:"POST",value:"post"}),(0,l.bF)(E,{label:"DELETE",value:"delete"}),(0,l.bF)(E,{label:"PUT",value:"put"}),(0,l.bF)(E,{label:"PATCH",value:"patch"}),(0,l.bF)(E,{label:"OPTION",value:"option"})])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])])),_:1}),(0,l.bF)(L,{span:6,style:{"text-align":"right"}},{default:(0,l.k6)((()=>[(0,l.bF)(T,{type:"success",icon:"Promotion",onClick:V.runCase},{default:(0,l.k6)((()=>t[28]||(t[28]=[(0,l.eW)("Run")]))),_:1,__:[28]},8,["onClick"])])),_:1})])),_:1}),(0,l.bF)(w,{"content-position":"left"},{default:(0,l.k6)((()=>t[29]||(t[29]=[(0,l.Lk)("b",null,"用例信息",-1)]))),_:1,__:[29]}),(0,l.bF)(X,null,{default:(0,l.k6)((()=>[(0,l.bF)(L,{span:12},{default:(0,l.k6)((()=>[(0,l.bF)(D,{modelValue:x.name,"onUpdate:modelValue":t[2]||(t[2]=e=>x.name=e),placeholder:"用例名称",class:"input-with-select"},{prepend:(0,l.k6)((()=>t[30]||(t[30]=[(0,l.eW)(" 用例名称 ")]))),_:1},8,["modelValue"])])),_:1}),(0,l.bF)(L,{span:12,style:{"text-align":"right"}},{default:(0,l.k6)((()=>[(0,l.bF)(T,{type:"danger",icon:"Delete",onClick:V.deleteCase,plain:""},{default:(0,l.k6)((()=>t[31]||(t[31]=[(0,l.eW)("删除")]))),_:1,__:[31]},8,["onClick"]),(0,l.bF)(T,{type:"success",icon:"DocumentCopy",onClick:V.copyCase,plain:""},{default:(0,l.k6)((()=>t[32]||(t[32]=[(0,l.eW)("复制")]))),_:1,__:[32]},8,["onClick"]),(0,l.bF)(T,{type:"success",icon:"CircleCheck",onClick:V.saveCase},{default:(0,l.k6)((()=>t[33]||(t[33]=[(0,l.eW)("保存")]))),_:1,__:[33]},8,["onClick"])])),_:1})])),_:1}),(0,l.bF)(w,{"content-position":"left"},{default:(0,l.k6)((()=>t[34]||(t[34]=[(0,l.Lk)("b",null,"请求信息",-1)]))),_:1,__:[34]}),(0,l.bF)(P,{modelValue:x.activeTab,"onUpdate:modelValue":t[26]||(t[26]=e=>x.activeTab=e),type:"border-card",style:{"min-height":"350px"}},{default:(0,l.k6)((()=>[(0,l.bF)(U,{name:"head",label:"请求头(headers)"},{default:(0,l.k6)((()=>[(0,l.bF)(q,{height:"280px",modelValue:x.headers,"onUpdate:modelValue":t[3]||(t[3]=e=>x.headers=e)},null,8,["modelValue"])])),_:1}),(0,l.bF)(U,{name:"params",label:"查询参数(params)"},{default:(0,l.k6)((()=>[(0,l.bF)(q,{height:"280px",modelValue:x.params,"onUpdate:modelValue":t[4]||(t[4]=e=>x.params=e)},null,8,["modelValue"])])),_:1}),(0,l.bF)(U,{name:"body",label:"请求体(body)"},{default:(0,l.k6)((()=>[(0,l.bF)(I,{modelValue:x.bodyType,"onUpdate:modelValue":t[5]||(t[5]=e=>x.bodyType=e),class:"ml-4"},{default:(0,l.k6)((()=>[(0,l.bF)(R,{value:"json",size:"large"},{default:(0,l.k6)((()=>t[35]||(t[35]=[(0,l.eW)("application/json")]))),_:1,__:[35]}),(0,l.bF)(R,{value:"form",size:"large"},{default:(0,l.k6)((()=>t[36]||(t[36]=[(0,l.eW)("x-www-form-urlencode")]))),_:1,__:[36]}),(0,l.bF)(R,{value:"file",size:"large"},{default:(0,l.k6)((()=>t[37]||(t[37]=[(0,l.eW)("form-data")]))),_:1,__:[37]})])),_:1},8,["modelValue"]),(0,l.Lk)("div",null,["json"===x.bodyType?((0,l.uX)(),(0,l.Wv)(q,{key:0,height:"280px",modelValue:x.jsonParams,"onUpdate:modelValue":t[6]||(t[6]=e=>x.jsonParams=e),lang:"json"},null,8,["modelValue"])):"form"===x.bodyType?((0,l.uX)(),(0,l.Wv)(q,{key:1,height:"280px",modelValue:x.dataParams,"onUpdate:modelValue":t[7]||(t[7]=e=>x.dataParams=e),lang:"json"},null,8,["modelValue"])):((0,l.uX)(),(0,l.CE)("div",o,[(0,l.bF)(X,null,{default:(0,l.k6)((()=>[(0,l.bF)(L,{span:16},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(x.editFiles,(a=>((0,l.uX)(),(0,l.Wv)(X,{gutter:5,style:{"margin-bottom":"10px"}},{default:(0,l.k6)((()=>[(0,l.bF)(L,{span:7},{default:(0,l.k6)((()=>[(0,l.bF)(D,{modelValue:a[0],"onUpdate:modelValue":e=>a[0]=e,placeholder:"参数名"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),(0,l.bF)(L,{span:4},{default:(0,l.k6)((()=>[(0,l.bF)(W,{modelValue:a[1],"onUpdate:modelValue":e=>a[1]=e,class:"m-2",placeholder:"Select"},{default:(0,l.k6)((()=>[(0,l.bF)(E,{label:"text",value:"text"}),(0,l.bF)(E,{label:"file",value:"file"})])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1024),"file"==a[1]?((0,l.uX)(),(0,l.Wv)(L,{key:0,span:7},{default:(0,l.k6)((()=>[(0,l.bF)(W,{modelValue:a[2],"onUpdate:modelValue":e=>a[2]=e,class:"m-2",placeholder:"Select",style:{width:"100%"}},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(x.fileList,(e=>((0,l.uX)(),(0,l.Wv)(E,{label:e.info[0],value:e.info},null,8,["label","value"])))),256))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1024)):((0,l.uX)(),(0,l.Wv)(L,{key:1,span:7},{default:(0,l.k6)((()=>[(0,l.bF)(D,{modelValue:a[2],"onUpdate:modelValue":e=>a[2]=e,placeholder:"参数值"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)),(0,l.bF)(L,{span:6,style:{"text-align":"center"}},{default:(0,l.k6)((()=>[(0,l.bF)(T,{onClick:t[8]||(t[8]=t=>x.editFiles.splice(e.index,1)),icon:"Delete",type:"danger",plain:""})])),_:1})])),_:2},1024)))),256)),(0,l.bF)(T,{onClick:t[9]||(t[9]=e=>x.editFiles.push(["","text",""])),icon:"Plus",type:"success",plain:"",size:"small",style:{"margin-top":"10px"}})])),_:1}),(0,l.bF)(L,{span:8},{default:(0,l.k6)((()=>[(0,l.bF)(j,{class:"upload-demo",action:e.$api.uploadFile.url,headers:e.$api.uploadFile.headers,method:"post",name:"file","on-success":V.uploadSuccess},{default:(0,l.k6)((()=>[(0,l.bF)(T,{plain:"",type:"success"},{default:(0,l.k6)((()=>t[38]||(t[38]=[(0,l.eW)("上传文件")]))),_:1,__:[38]})])),_:1},8,["action","headers","on-success"]),(0,l.bF)(S,{data:x.fileList,height:250},{default:(0,l.k6)((()=>[(0,l.bF)(A,{label:"已有文件",width:"180"},{default:(0,l.k6)((e=>[(0,l.eW)((0,s.v_)(e.row.info[0]),1)])),_:1}),(0,l.bF)(A,{label:"类型",width:"180"},{default:(0,l.k6)((e=>[(0,l.eW)((0,s.v_)(e.row.info[2]),1)])),_:1})])),_:1},8,["data"])])),_:1})])),_:1})]))])])),_:1}),(0,l.bF)(U,{label:"前置脚本"},{default:(0,l.k6)((()=>[(0,l.bF)(X,{gutter:10},{default:(0,l.k6)((()=>[(0,l.bF)(L,{span:18},{default:(0,l.k6)((()=>[(0,l.bF)(q,{height:"280px",modelValue:x.setup_script,"onUpdate:modelValue":t[10]||(t[10]=e=>x.setup_script=e),lang:"python",theme:"monokai"},null,8,["modelValue"])])),_:1}),(0,l.bF)(L,{span:6},{default:(0,l.k6)((()=>[(0,l.bF)(w,{"content-position":"center"},{default:(0,l.k6)((()=>t[39]||(t[39]=[(0,l.eW)("脚本模板")]))),_:1,__:[39]}),(0,l.Lk)("div",n,[(0,l.bF)(T,{onClick:t[11]||(t[11]=e=>V.add_setup_script("gv")),type:"success",plain:""},{default:(0,l.k6)((()=>t[40]||(t[40]=[(0,l.eW)("预设全局变量")]))),_:1,__:[40]})]),(0,l.Lk)("div",u,[(0,l.bF)(T,{onClick:t[12]||(t[12]=e=>V.add_setup_script("env")),style:{"margin-top":"10px"},type:"success",plain:""},{default:(0,l.k6)((()=>t[41]||(t[41]=[(0,l.eW)("预设局部变量 ")]))),_:1,__:[41]})]),(0,l.Lk)("div",i,[(0,l.bF)(T,{onClick:t[13]||(t[13]=e=>V.add_setup_script("func")),style:{"margin-top":"10px"},type:"success",plain:""},{default:(0,l.k6)((()=>t[42]||(t[42]=[(0,l.eW)("调用全局函数 ")]))),_:1,__:[42]})]),(0,l.Lk)("div",r,[(0,l.bF)(T,{onClick:t[14]||(t[14]=e=>V.add_setup_script("sql")),style:{"margin-top":"10px"},type:"success",plain:""},{default:(0,l.k6)((()=>t[43]||(t[43]=[(0,l.eW)("执行sql查询 ")]))),_:1,__:[43]})])])),_:1})])),_:1})])),_:1}),(0,l.bF)(U,{label:"后置脚本"},{default:(0,l.k6)((()=>[(0,l.bF)(X,{gutter:10},{default:(0,l.k6)((()=>[(0,l.bF)(L,{span:18},{default:(0,l.k6)((()=>[(0,l.bF)(q,{height:"280px",modelValue:x.teardown_script,"onUpdate:modelValue":t[15]||(t[15]=e=>x.teardown_script=e),lang:"python",theme:"monokai"},null,8,["modelValue"])])),_:1}),(0,l.bF)(L,{span:6},{default:(0,l.k6)((()=>[(0,l.bF)(w,null,{default:(0,l.k6)((()=>t[44]||(t[44]=[(0,l.eW)("脚本模板")]))),_:1,__:[44]}),(0,l.bF)(N,{height:"250px"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",c,[(0,l.bF)(T,{type:"success",plain:"",onClick:t[16]||(t[16]=e=>V.addTearDownCodeMod("getBody"))},{default:(0,l.k6)((()=>t[45]||(t[45]=[(0,l.eW)("获取响应体")]))),_:1,__:[45]})]),(0,l.Lk)("div",p,[(0,l.bF)(T,{type:"success",plain:"",onClick:t[17]||(t[17]=e=>V.addTearDownCodeMod("JSextract"))},{default:(0,l.k6)((()=>t[46]||(t[46]=[(0,l.eW)("jsonpath提取数据")]))),_:1,__:[46]})]),(0,l.Lk)("div",_,[(0,l.bF)(T,{type:"success",plain:"",onClick:t[18]||(t[18]=e=>V.addTearDownCodeMod("REextract"))},{default:(0,l.k6)((()=>t[47]||(t[47]=[(0,l.eW)("正则提取数据")]))),_:1,__:[47]})]),(0,l.Lk)("div",b,[(0,l.bF)(T,{type:"success",plain:"",onClick:t[19]||(t[19]=e=>V.addTearDownCodeMod("ENV"))},{default:(0,l.k6)((()=>t[48]||(t[48]=[(0,l.eW)("设置全局变量")]))),_:1,__:[48]})]),(0,l.Lk)("div",m,[(0,l.bF)(T,{type:"success",plain:"",onClick:t[20]||(t[20]=e=>V.addTearDownCodeMod("env"))},{default:(0,l.k6)((()=>t[49]||(t[49]=[(0,l.eW)("设置局部变量")]))),_:1,__:[49]})]),(0,l.Lk)("div",k,[(0,l.bF)(T,{type:"success",plain:"",onClick:t[21]||(t[21]=e=>V.addTearDownCodeMod("func"))},{default:(0,l.k6)((()=>t[50]||(t[50]=[(0,l.eW)("调用全局函数")]))),_:1,__:[50]})]),(0,l.Lk)("div",h,[(0,l.bF)(T,{type:"success",plain:"",onClick:t[22]||(t[22]=e=>V.addTearDownCodeMod("sql"))},{default:(0,l.k6)((()=>t[51]||(t[51]=[(0,l.eW)("执行sql查询")]))),_:1,__:[51]})]),(0,l.Lk)("div",f,[(0,l.bF)(T,{type:"success",plain:"",onClick:t[23]||(t[23]=e=>V.addTearDownCodeMod("http"))},{default:(0,l.k6)((()=>t[52]||(t[52]=[(0,l.eW)("断言HTTP状态码")]))),_:1,__:[52]})]),(0,l.Lk)("div",g,[(0,l.bF)(T,{type:"success",plain:"",onClick:t[24]||(t[24]=e=>V.addTearDownCodeMod("eq"))},{default:(0,l.k6)((()=>t[53]||(t[53]=[(0,l.eW)("断言相等")]))),_:1,__:[53]})]),(0,l.Lk)("div",y,[(0,l.bF)(T,{type:"success",plain:"",onClick:t[25]||(t[25]=e=>V.addTearDownCodeMod("contain"))},{default:(0,l.k6)((()=>t[54]||(t[54]=[(0,l.eW)("断言包含")]))),_:1,__:[54]})])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]),x.runResult?((0,l.uX)(),(0,l.CE)("div",F,[(0,l.bF)(w,{"content-position":"left"},{default:(0,l.k6)((()=>t[55]||(t[55]=[(0,l.Lk)("b",null,"响应信息",-1)]))),_:1,__:[55]}),(0,l.Lk)("div",v,[(0,l.bF)(O,{content:"清空当前测试用例的响应数据",placement:"top"},{default:(0,l.k6)((()=>[(0,l.bF)(T,{onClick:V.clearRunResult,type:"danger",icon:e.Delete,size:"medium",style:{width:"140px"}},{default:(0,l.k6)((()=>t[56]||(t[56]=[(0,l.eW)(" 清空响应 ")]))),_:1,__:[56]},8,["onClick","icon"])])),_:1})]),(0,l.bF)(B,{result:x.runResult},null,8,["result"])])):(0,l.Q3)("",!0)])}a(8111),a(7588);var x=a(766),V=a(2933),w=a(1219),E=a(782),W=a(5338),D=a(7477),L={components:{CodeEdit:x.A,CaseResult:W.A,Delete:D.Delete},props:["editCase"],data(){return{fileList:[],activeTab:"body",bodyType:"json",caseInfo:null,runResult:null,url:"",method:"get",name:"",headers:"{}",params:"{}",setup_script:"",teardown_script:"",jsonParams:"",dataParams:"",editFiles:[]}},computed:{...(0,E.aH)(["envId"])},methods:{...(0,E.i0)(["getAllInterFaces"]),async getCaseDesc(){const e=await this.$api.getCaseInfo(this.editCase.id);200===e.status&&(this.caseInfo=e.data,this.initEditData())},deleteCase(){V.s.confirm("确定要删除该用例吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const e=await this.$api.delTeststep(this.caseInfo.id);204===e.status&&((0,w.nk)({type:"success",message:"删除成功",duration:1e3}),this.getAllInterFaces())})).catch((()=>{(0,w.nk)({type:"info",message:"取消删除",duration:1e3})}))},async saveCase(){const e=this.resetEditData(),t=await this.$api.updateTeststep(this.caseInfo.id,e);200===t.status&&((0,w.nk)({type:"success",message:"保存成功",duration:1e3}),this.getAllInterFaces())},async copyCase(){const e=this.resetEditData();e.title=e.title+"_copy";const t=await this.$api.createTeststep(e);201===t.status&&((0,w.nk)({type:"success",message:"复制成功",duration:1e3}),this.getAllInterFaces())},async runCase(){const e=this.resetEditData();e.interface={url:this.caseInfo.interface.url,method:this.caseInfo.interface.method};const t={data:e,env:this.envId},a=await this.$api.runTest(t);200===a.status?(this.runResult=a.data,(0,w.nk)({type:"success",message:"执行完毕",duration:1e3})):(0,w.nk)({type:"error",message:"执行失败: "+a.data,duration:1e3})},initEditData(){const e={...this.caseInfo};this.method=e.interface.method,this.url=e.interface.url,this.name=e.title,this.headers=JSON.stringify(e.headers||{},null,2),this.params=JSON.stringify(e.request.params||{},null,2),this.setup_script=e.setup_script,this.teardown_script=e.teardown_script,this.jsonParams=JSON.stringify(e.request.json||{},null,2),this.dataParams=JSON.stringify(e.request.data||{},null,2),e.file.forEach((e=>{3===e[1].length?this.editFiles.push([e[0],"file",e[1]]):this.editFiles.push([e[0],"text",e[1]])}))},resetEditData(){let e={...this.caseInfo};if(e.interface=this.caseInfo.interface.id,e.title=this.name,e.headers=JSON.parse(this.headers),e.setup_script=this.setup_script,e.teardown_script=this.teardown_script,e.request={},e.request.params=JSON.parse(this.params),"json"===this.bodyType)e.request.json=JSON.parse(this.jsonParams);else if("data"===this.bodyType)e.request.data=JSON.parse(this.dataParams);else{const t=[];this.editFiles.file.forEach((e=>{t.push([e[0],e[2]])})),e.file=t}return e},add_setup_script(e){"gv"===e?this.setup_script+='# 设置全局变量 \ntest.save_global_variable("变量名","变量值")\n':"env"===e?this.setup_script+='\n# 设置局部变量  \ntest.save_env_variable("变量名","变量值")':"func"===e?this.setup_script+="\n# 调用全局工具函数random_mobile随机生成一个手机号码  \nmobile = global_func.random_mobile()":"sql"===e&&(this.setup_script+='# ----执行sql语句(需要在环境中配置数据库连接信息)----\n# db.连接名.execute_all(sql语句)\nsql = "SELECT count(*) as count FROM futureloan.member"\n res = db.aliyun.execute_all(sql)\n')},addTearDownCodeMod(e){switch(e){case"getBody":this.teardown_script+="\n# Demo:获取响应体(json)  \nbody = response.json()",this.teardown_script+="\n# Demo2:获取响应体(字符串)  \nbody = response.text";break;case"JSextract":this.teardown_script+='\n# Demo:jsonpath提取response中的msg字段  \nmsg = test.json_extract(response.json(),"$..msg")';break;case"REextract":this.teardown_script+='\n# Demo:正则提取响应体中的数据  \nres = test.re_extract(response.text,"正则表达式",)';break;case"ENV":this.teardown_script+='\n# 设置全局变量 \ntest.save_global_variable("变量名","变量值")';break;case"env":this.teardown_script+='\n# 设置局部变量  \ntest.save_env_variable("变量名","变量值")';break;case"func":this.teardown_script+="\n# 调用全局工具函数random_mobile随机生成一个手机号码  \nmobile = global_func.random_mobile()";break;case"sql":this.teardown_script+='\n# ----执行sql语句(需要在环境中配置数据库连接信息)----\n# db.连接名.execute_all(sql语句) \nsql = "SELECT count(*) as count FROM futureloan.member"\nres = db.aliyun.execute_all(sql)';break;case"http":this.teardown_script+='\n# 断言http状态码 \n# Demo:断言http状态码是否为200  \ntest.assertion("相等",200,response.status_code)';break;case"eq":this.teardown_script+='\n# 断言相等 \ntest.assertion("相等","预期结果","实际结果")';break;case"contain":this.teardown_script+='\n# 断言包含:预期结果中的内容在实际结果中是否存在 \ntest.assertion("包含","预期结果","实际结果")';break}},async getAllFile(){const e=await this.$api.getFiles();this.fileList=e.data},uploadSuccess(){this.getAllFile(),(0,w.nk)({message:"文件上传成功",type:"success"})},clearRunResult(){this.runResult=null,this.$message({message:"响应信息已清空",type:"success"})}},created(){this.editCase&&this.getCaseDesc(),this.getAllFile()},watch:{editCase(e){this.editCase&&this.getCaseDesc()}}},T=a(1241);const X=(0,T.A)(L,[["render",C],["__scopeId","data-v-2c6903e6"]]);var q=X},5338:function(e,t,a){a.d(t,{A:function(){return E}});var l=a(6768),s=a(4232);const d={key:0},o={key:0},n={key:1},u={key:0,class:"tab-box-sli"},i={style:{color:"#747474"}},r={key:0},c={key:0,class:"tab-box-sli"},p={style:{color:"#747474"}},_={key:4,style:{color:"#d60000"}},b={key:0,style:{color:"#00AA7F"}},m={key:1,style:{color:"#d18d17"}},k={key:2,style:{color:"#ff0000"}},h={key:0,style:{color:"#00AA7F"}},f={key:1,style:{color:"#ff5500"}},g={key:0,style:{"margin-top":"10px",width:"100%","text-align":"center"}},y={class:"dialog-footer"};function F(e,t,a,F,v,C){const x=(0,l.g2)("Editor"),V=(0,l.g2)("el-tab-pane"),w=(0,l.g2)("el-tag"),E=(0,l.g2)("el-collapse-item"),W=(0,l.g2)("el-collapse"),D=(0,l.g2)("el-scrollbar"),L=(0,l.g2)("el-tabs"),T=(0,l.g2)("el-button"),X=(0,l.g2)("el-option"),q=(0,l.g2)("el-select"),U=(0,l.g2)("el-form-item"),R=(0,l.g2)("el-input"),I=(0,l.g2)("el-form"),j=(0,l.g2)("el-dialog");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.bF)(L,{"model-value":"rb",style:{"min-height":"300px",width:"100%"},type:"border-card",value:"rb",size:"small"},{default:(0,l.k6)((()=>[(0,l.bF)(V,{label:"响应体",name:"rb"},{default:(0,l.k6)((()=>[a.result.response_header?((0,l.uX)(),(0,l.CE)("div",d,[-1!=a.result.response_header.search("application/json")?((0,l.uX)(),(0,l.CE)("div",o,[(0,l.bF)(x,{"read-only":!0,modelValue:a.result.response_body,"onUpdate:modelValue":t[0]||(t[0]=e=>a.result.response_body=e),lang:"json",theme:"chrome"},null,8,["modelValue"])])):((0,l.uX)(),(0,l.CE)("div",n,[(0,l.bF)(x,{"read-only":!0,modelValue:a.result.response_body,"onUpdate:modelValue":t[1]||(t[1]=e=>a.result.response_body=e),lang:"html",theme:"chrome",height:"500px"},null,8,["modelValue"])]))])):(0,l.Q3)("",!0)])),_:1}),(0,l.bF)(V,{label:"响应头",name:"rh"},{default:(0,l.k6)((()=>[a.result.response_header?((0,l.uX)(),(0,l.CE)("div",u,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(JSON.parse(a.result.response_header||"{}"),((e,t)=>((0,l.uX)(),(0,l.CE)("div",null,[(0,l.bF)(w,{style:{"margin-top":"3px","white-space":"pre-wrap"},type:"info"},{default:(0,l.k6)((()=>[(0,l.Lk)("b",i,(0,s.v_)(t+": "),1),(0,l.Lk)("span",null,(0,s.v_)(e),1)])),_:2},1024)])))),256))])):(0,l.Q3)("",!0)])),_:1}),(0,l.bF)(V,{label:"请求信息",name:"rq"},{default:(0,l.k6)((()=>[a.result.requests_body?((0,l.uX)(),(0,l.CE)("div",r,[(0,l.bF)(W,{modelValue:v.activeNames,"onUpdate:modelValue":t[2]||(t[2]=e=>v.activeNames=e),class:"tab-box-sli"},{default:(0,l.k6)((()=>[(0,l.bF)(E,{name:"1"},{title:(0,l.k6)((()=>t[8]||(t[8]=[(0,l.Lk)("b",null,"General",-1)]))),default:(0,l.k6)((()=>[(0,l.Lk)("div",null,"Request Method : "+(0,s.v_)(a.result.method),1),(0,l.Lk)("div",null,"Request URL : "+(0,s.v_)(a.result.url),1)])),_:1}),(0,l.bF)(E,{name:"2"},{title:(0,l.k6)((()=>t[9]||(t[9]=[(0,l.Lk)("b",null,"Request Headers",-1)]))),default:(0,l.k6)((()=>[a.result.requests_header?((0,l.uX)(),(0,l.CE)("div",c,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)("string"===typeof a.result.requests_header?JSON.parse(a.result.requests_header||"{}"):a.result.requests_header,((e,t)=>((0,l.uX)(),(0,l.CE)("div",null,[(0,l.bF)(w,{style:{"margin-top":"3px","white-space":"pre-wrap"},type:"info"},{default:(0,l.k6)((()=>[(0,l.Lk)("b",p,(0,s.v_)(t+": "),1),(0,l.Lk)("span",null,(0,s.v_)(e),1)])),_:2},1024)])))),256))])):(0,l.Q3)("",!0)])),_:1}),(0,l.bF)(E,{name:"3"},{title:(0,l.k6)((()=>t[10]||(t[10]=[(0,l.Lk)("b",null,"Request Payload",-1)]))),default:(0,l.k6)((()=>[(0,l.Lk)("span",null,(0,s.v_)(a.result.requests_body),1)])),_:1})])),_:1},8,["modelValue"])])):(0,l.Q3)("",!0)])),_:1}),(0,l.bF)(V,{label:"日志"},{default:(0,l.k6)((()=>[(0,l.bF)(D,{style:{width:"100%"},height:"350px"},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(a.result.log_data,((e,t)=>((0,l.uX)(),(0,l.CE)("div",null,["DEBUG"===e[0]?((0,l.uX)(),(0,l.Wv)(w,{key:0,style:{"margin-top":"3px"},type:"info"},{default:(0,l.k6)((()=>[(0,l.eW)((0,s.v_)(e[1]),1)])),_:2},1024)):"WARNING"===e[0]?((0,l.uX)(),(0,l.Wv)(w,{key:1,style:{"margin-top":"3px"},type:"warning"},{default:(0,l.k6)((()=>[(0,l.eW)((0,s.v_)(e[1]),1)])),_:2},1024)):"ERROR"===e[0]?((0,l.uX)(),(0,l.Wv)(w,{key:2,style:{"margin-top":"3px"},type:"danger"},{default:(0,l.k6)((()=>[(0,l.eW)((0,s.v_)(e[1]),1)])),_:2},1024)):"INFO"===e[0]?((0,l.uX)(),(0,l.Wv)(w,{key:3,style:{"margin-top":"3px"},type:"success"},{default:(0,l.k6)((()=>[(0,l.eW)((0,s.v_)(e[1]),1)])),_:2},1024)):"EXCEPT"===e[0]?((0,l.uX)(),(0,l.CE)("pre",_,(0,s.v_)(e[1]),1)):(0,l.Q3)("",!0)])))),256))])),_:1})])),_:1}),(0,l.bF)(V,{disabled:""},{label:(0,l.k6)((()=>["成功"===a.result.state?((0,l.uX)(),(0,l.CE)("span",b,(0,s.v_)("Assert : "+a.result.state),1)):"失败"===a.result.state?((0,l.uX)(),(0,l.CE)("span",m,(0,s.v_)("Assert : "+a.result.state),1)):((0,l.uX)(),(0,l.CE)("span",k,(0,s.v_)(a.result.state),1))])),_:1}),(0,l.bF)(V,{disabled:""},{label:(0,l.k6)((()=>[a.result.status_cede<=300?((0,l.uX)(),(0,l.CE)("span",h,(0,s.v_)("Status : "+a.result.status_cede),1)):((0,l.uX)(),(0,l.CE)("span",f,(0,s.v_)("Status : "+a.result.status_cede),1))])),_:1}),(0,l.bF)(V,{disabled:""},{label:(0,l.k6)((()=>[(0,l.eW)((0,s.v_)("Time : "+a.result.run_time),1)])),_:1})])),_:1}),"失败"===a.result.state&&a.showbtn?((0,l.uX)(),(0,l.CE)("div",g,[(0,l.bF)(T,{onClick:t[3]||(t[3]=e=>v.addBugDlg=!0),type:"success",plain:"",size:"small"},{default:(0,l.k6)((()=>t[11]||(t[11]=[(0,l.eW)("提交bug")]))),_:1,__:[11]})])):(0,l.Q3)("",!0),(0,l.bF)(j,{title:"提交bug",modelValue:v.addBugDlg,"onUpdate:modelValue":t[7]||(t[7]=e=>v.addBugDlg=e),width:"40%"},{footer:(0,l.k6)((()=>[(0,l.Lk)("div",y,[(0,l.bF)(T,{onClick:t[6]||(t[6]=e=>v.addBugDlg=!1)},{default:(0,l.k6)((()=>t[12]||(t[12]=[(0,l.eW)("取 消")]))),_:1,__:[12]}),(0,l.bF)(T,{type:"success",onClick:C.saveBug},{default:(0,l.k6)((()=>t[13]||(t[13]=[(0,l.eW)("确 定")]))),_:1,__:[13]},8,["onClick"])])])),default:(0,l.k6)((()=>[(0,l.bF)(I,{model:v.bugForm},{default:(0,l.k6)((()=>[(0,l.bF)(U,{label:"所属接口"},{default:(0,l.k6)((()=>[(0,l.bF)(q,{size:"small",modelValue:v.bugForm.interface,"onUpdate:modelValue":t[4]||(t[4]=e=>v.bugForm.interface=e),placeholder:"bug对应的接口",style:{width:"100%"}},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.interfaces,(e=>((0,l.uX)(),(0,l.Wv)(X,{label:e.name+" "+e.url,value:e.id,key:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,l.bF)(U,{label:"bug描述"},{default:(0,l.k6)((()=>[(0,l.bF)(R,{autosize:{minRows:3,maxRows:4},modelValue:v.bugForm.desc,"onUpdate:modelValue":t[5]||(t[5]=e=>v.bugForm.desc=e),type:"textarea",autocomplete:"off"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])],64)}var v=a(766),C=a(782),x={props:{result:{default:{}},showbtn:{default:!0}},computed:{...(0,C.aH)(["pro","interfaces"])},components:{Editor:v.A},data(){return{activeNames:["1","2","3"],addBugDlg:!1,bugForm:{interface:null,desc:"",info:"",status:"未处理"}}},methods:{async saveBug(){this.bugForm.project=this.pro.id,this.bugForm.info=this.result;const e=await this.$api.createBugs(this.bugForm);201===e.status&&(this.$message({type:"success",message:"bug提交成功",duration:1e3}),this.addBugDlg=!1)}}},V=a(1241);const w=(0,V.A)(x,[["render",F]]);var E=w}}]);
//# sourceMappingURL=999.866f0b76.js.map