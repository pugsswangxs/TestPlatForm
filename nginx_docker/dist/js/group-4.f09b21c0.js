"use strict";(self["webpackChunkapi_test_platform"]=self["webpackChunkapi_test_platform"]||[]).push([[175],{204:function(e,l,a){a.r(l),a.d(l,{default:function(){return g}});var t=a(6768),s=a(4232);const n={class:"list_box"};function o(e,l,a,o,i,d){const u=(0,t.g2)("el-button"),v=(0,t.g2)("Coin"),c=(0,t.g2)("el-icon"),b=(0,t.g2)("el-menu-item"),r=(0,t.g2)("el-menu"),g=(0,t.g2)("el-scrollbar"),h=(0,t.g2)("el-col"),p=(0,t.g2)("el-input"),_=(0,t.g2)("Editor"),f=(0,t.g2)("el-tab-pane"),E=(0,t.g2)("el-tabs"),m=(0,t.g2)("el-affix"),k=(0,t.g2)("el-row");return(0,t.uX)(),(0,t.Wv)(k,{gutter:10},{default:(0,t.k6)((()=>[(0,t.bF)(h,{span:4},{default:(0,t.k6)((()=>[(0,t.Lk)("div",n,[(0,t.bF)(g,{height:"calc(100vh - 144px)"},{default:(0,t.k6)((()=>[l[8]||(l[8]=(0,t.Lk)("div",{class:"top-title"},"测试环境",-1)),(0,t.bF)(u,{onClick:d.addEnv,type:"success",plain:"",size:"small",style:{width:"100%"},icon:"Plus"},{default:(0,t.k6)((()=>l[7]||(l[7]=[(0,t.eW)("创建测试环境 ")]))),_:1,__:[7]},8,["onClick"]),(0,t.bF)(r,{"default-active":i.active,class:"el-menu-vertical-demo","active-text-color":"#00aa7f","text-color":"#000000",style:{background:"none",border:"none"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.testEnvs,(e=>((0,t.uX)(),(0,t.Wv)(b,{onClick:l=>d.selectEnv(e),index:e.id.toString(),style:{height:"35px","line-height":"35px"}},{default:(0,t.k6)((()=>[(0,t.bF)(c,null,{default:(0,t.k6)((()=>[(0,t.bF)(v)])),_:1}),(0,t.Lk)("span",null,(0,s.v_)(e.name),1)])),_:2},1032,["onClick","index"])))),256))])),_:1},8,["default-active"])])),_:1,__:[8]})])])),_:1}),i.EnvInfo?((0,t.uX)(),(0,t.Wv)(h,{key:0,span:8},{default:(0,t.k6)((()=>[(0,t.bF)(g,{height:"calc(100vh - 70px )"},{default:(0,t.k6)((()=>[l[14]||(l[14]=(0,t.Lk)("div",{class:"title"},"基本信息",-1)),(0,t.bF)(p,{modelValue:i.EnvInfo.name,"onUpdate:modelValue":l[0]||(l[0]=e=>i.EnvInfo.name=e),placeholder:"环境名称"},{prepend:(0,t.k6)((()=>l[9]||(l[9]=[(0,t.eW)(" 环境名 ")]))),_:1},8,["modelValue"]),(0,t.bF)(p,{modelValue:i.EnvInfo.host,"onUpdate:modelValue":l[1]||(l[1]=e=>i.EnvInfo.host=e),placeholder:"hots地址",style:{"margin-top":"5px"}},{prepend:(0,t.k6)((()=>l[10]||(l[10]=[(0,t.eW)(" 服务器域名 ")]))),_:1},8,["modelValue"]),l[15]||(l[15]=(0,t.Lk)("div",{class:"title"},"基本配置",-1)),(0,t.bF)(E,{type:"border-card",class:"demo-tabs"},{default:(0,t.k6)((()=>[(0,t.bF)(f,{label:"全局请求头"},{default:(0,t.k6)((()=>[(0,t.bF)(_,{modelValue:i.EnvInfo.headers,"onUpdate:modelValue":l[2]||(l[2]=e=>i.EnvInfo.headers=e),height:"250px"},null,8,["modelValue"])])),_:1}),(0,t.bF)(f,{label:"数据库配置"},{default:(0,t.k6)((()=>[(0,t.bF)(_,{modelValue:i.EnvInfo.db,"onUpdate:modelValue":l[3]||(l[3]=e=>i.EnvInfo.db=e),height:"250px"},null,8,["modelValue"])])),_:1})])),_:1}),l[16]||(l[16]=(0,t.Lk)("div",{class:"title"},"全局变量",-1)),(0,t.bF)(E,{type:"border-card",class:"demo-tabs"},{default:(0,t.k6)((()=>[(0,t.bF)(f,{label:"全局变量"},{default:(0,t.k6)((()=>[(0,t.bF)(_,{modelValue:i.EnvInfo.global_variables,"onUpdate:modelValue":l[4]||(l[4]=e=>i.EnvInfo.global_variables=e),height:"250px"},null,8,["modelValue"])])),_:1}),(0,t.bF)(f,{label:"调试运行变量"},{default:(0,t.k6)((()=>[(0,t.bF)(_,{modelValue:i.EnvInfo.debug_globals_variables,"onUpdate:modelValue":l[5]||(l[5]=e=>i.EnvInfo.debug_globals_variables=e),height:"250px"},null,8,["modelValue"])])),_:1})])),_:1}),i.EnvInfo?((0,t.uX)(),(0,t.Wv)(m,{key:0,position:"bottom",offset:20,style:{"text-align":"center"}},{default:(0,t.k6)((()=>[(0,t.bF)(u,{onClick:d.saveEnv,type:"success",plain:"",icon:"CircleCheck"},{default:(0,t.k6)((()=>l[11]||(l[11]=[(0,t.eW)("保存编辑")]))),_:1,__:[11]},8,["onClick"]),(0,t.bF)(u,{onClick:d.copyEnv,type:"success",plain:"",icon:"CircleCheck"},{default:(0,t.k6)((()=>l[12]||(l[12]=[(0,t.eW)("复制环境")]))),_:1,__:[12]},8,["onClick"]),(0,t.bF)(u,{onClick:d.delEnv,type:"danger",plain:"",icon:"Delete"},{default:(0,t.k6)((()=>l[13]||(l[13]=[(0,t.eW)("删除环境")]))),_:1,__:[13]},8,["onClick"])])),_:1})):(0,t.Q3)("",!0)])),_:1,__:[14,15,16]})])),_:1})):(0,t.Q3)("",!0),i.EnvInfo?((0,t.uX)(),(0,t.Wv)(h,{key:1,span:12},{default:(0,t.k6)((()=>[(0,t.bF)(_,{modelValue:i.EnvInfo.global_func,"onUpdate:modelValue":l[6]||(l[6]=e=>i.EnvInfo.global_func=e),height:"calc(100vh - 65px)",lang:"python",theme:"monokai"},null,8,["modelValue"])])),_:1})):(0,t.Q3)("",!0)])),_:1})}var i=a(782),d=a(766),u=a(2933),v=a(1219),c={components:{Editor:d.A},data(){return{active:"1",EnvInfo:null}},computed:{...(0,i.aH)(["pro","testEnvs"])},methods:{...(0,i.i0)(["getAllEnvs"]),async addEnv(){try{const e={project:this.pro.id,name:"New Env",headers:{},db:{},global_variables:{},debug_globals_variables:{},global_func:""},l=await this.$api.createTestEnvs(e);201===l.status&&(this.$message.success("添加成功"),this.getAllEnvs())}catch(e){this.$message.error(`创建失败: ${e.message}`)}},async delEnv(){u.s.confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const e=await this.$api.delTestEnvs(this.EnvInfo.id);204===e.status&&((0,v.nk)({type:"success",message:"删除成功",duration:1e3}),this.getAllEnvs(),this.testEnvs.length>0&&(this.active=this.testEnvs[0].id.toString(),this.selectEnv(this.testEnvs[0])))})).catch((()=>{(0,v.nk)({type:"info",message:"取消删除",duration:1e3})}))},async saveEnv(){let e={...this.EnvInfo};e.headers=JSON.parse(this.EnvInfo.headers),e.db=JSON.parse(this.EnvInfo.db),e.debug_globals_variables=JSON.parse(this.EnvInfo.debug_globals_variables),e.global_variables=JSON.parse(this.EnvInfo.global_variables);const l=await this.$api.updateTestEnvs(e.id,e);200===l.status&&(this.$message({type:"success",message:"保存成功",duration:1e3}),this.getAllEnvs())},async copyEnv(){let e={...this.EnvInfo};e.name=e.name+"_COPY",e.headers=JSON.parse(this.EnvInfo.headers),e.db=JSON.parse(this.EnvInfo.db),e.debug_globals_variables=JSON.parse(this.EnvInfo.debug_globals_variables),e.global_variables=JSON.parse(this.EnvInfo.global_variables);const l=await this.$api.createTestEnvs(e);201===l.status&&(this.$message({type:"success",message:"复制成功",duration:1e3}),this.getAllEnvs())},selectEnv(e){this.active=e.id.toString(),this.EnvInfo={...e,headers:e.headers?JSON.stringify(e.headers,null,4):"{}",db:e.db?JSON.stringify(e.db,null,4):"{}",debug_globals_variables:e.debug_globals_variables?JSON.stringify(e.debug_globals_variables,null,4):"{}",global_variables:e.global_variables?JSON.stringify(e.global_variables,null,4):"{}"}}},created(){this.getAllEnvs()},mounted(){this.testEnvs.length>0&&this.selectEnv(this.testEnvs[0])}},b=a(1241);const r=(0,b.A)(c,[["render",o],["__scopeId","data-v-49e8e615"]]);var g=r}}]);
//# sourceMappingURL=group-4.f09b21c0.js.map