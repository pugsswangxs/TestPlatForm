"use strict";(self["webpackChunkapi_test_platform"]=self["webpackChunkapi_test_platform"]||[]).push([[592],{838:function(e,t,l){l.r(t),l.d(t,{default:function(){return m}});var a=l(6768),s=l(4232);const n={style:{"text-align":"center"},slot:"title"},o={key:0,style:{"font-size":"18px","font-weight":"bold"}},i={key:1,style:{"font-size":"18px","font-weight":"bold"}},d={slot:"footer",class:"dialog-footer",style:{"text-align":"center"}};function r(e,t,l,r,u,c){const p=(0,a.g2)("el-button"),h=(0,a.g2)("el-table-column"),m=(0,a.g2)("el-switch"),g=(0,a.g2)("el-tooltip"),b=(0,a.g2)("el-table"),k=(0,a.g2)("el-input"),f=(0,a.g2)("el-form-item"),y=(0,a.g2)("el-option"),C=(0,a.g2)("el-select"),_=(0,a.g2)("el-col"),v=(0,a.g2)("el-row"),w=(0,a.g2)("el-form"),F=(0,a.g2)("el-dialog");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(p,{onClick:t[0]||(t[0]=e=>{u.dialogCron=!0,u.updateBtn=!1}),style:{margin:"10px 5px"},type:"success",icon:"el-icon-plus",size:"small"},{default:(0,a.k6)((()=>t[10]||(t[10]=[(0,a.eW)("添加定时任务 ")]))),_:1,__:[10]}),(0,a.bF)(b,{data:u.cronList,style:{width:"100%"},size:"small"},{default:(0,a.k6)((()=>[(0,a.bF)(h,{label:"创建时间","min-width":"180"},{default:(0,a.k6)((t=>[(0,a.eW)((0,s.v_)(e.$date.rTime(t.row.create_time)),1)])),_:1}),(0,a.bF)(h,{prop:"name",label:"名称","min-width":"140"}),(0,a.bF)(h,{prop:"plan_name",label:"执行任务","min-width":"140"}),(0,a.bF)(h,{prop:"env_name",label:"执行环境","min-width":"140"}),(0,a.bF)(h,{prop:"rule",label:"执行规则","min-width":"140"}),(0,a.bF)(h,{label:"是否开启","min-width":"120"},{default:(0,a.k6)((e=>[(0,a.bF)(m,{onChange:t=>c.switchCronStatus(e.row),modelValue:e.row.status,"onUpdate:modelValue":t=>e.row.status=t,"active-color":"#13ce66","inactive-color":"#b1b1b1"},null,8,["onChange","modelValue","onUpdate:modelValue"])])),_:1}),(0,a.bF)(h,{label:"操作","min-width":"100"},{default:(0,a.k6)((e=>[(0,a.bF)(g,{class:"item",effect:"dark",content:"编辑",placement:"top"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{onClick:t=>c.showUpdateCronDlg(e.row),type:"success",size:"small",icon:"Edit"},null,8,["onClick"])])),_:2},1024),(0,a.bF)(g,{class:"item",effect:"dark",content:"删除",placement:"top"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{onClick:t=>c.delCron(e.row.id),type:"danger",size:"small",icon:"Delete"},null,8,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data"]),(0,a.bF)(F,{modelValue:u.dialogCron,"onUpdate:modelValue":t[9]||(t[9]=e=>u.dialogCron=e),width:"45%"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",n,[u.updateBtn?((0,a.uX)(),(0,a.CE)("span",o,"修改定时执行任务")):((0,a.uX)(),(0,a.CE)("span",i,"创建定时执行任务"))]),(0,a.bF)(w,{model:u.cronTabData,ref:"cronTabData","label-width":"80px"},{default:(0,a.k6)((()=>[(0,a.bF)(f,{label:"名称"},{default:(0,a.k6)((()=>[(0,a.bF)(k,{modelValue:u.cronTabData.name,"onUpdate:modelValue":t[1]||(t[1]=e=>u.cronTabData.name=e)},null,8,["modelValue"])])),_:1}),(0,a.bF)(f,{label:"测试环境"},{default:(0,a.k6)((()=>[(0,a.bF)(C,{modelValue:u.cronTabData.env,"onUpdate:modelValue":t[2]||(t[2]=e=>u.cronTabData.env=e),placeholder:"请选择环境",style:{width:"100%"}},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.testEnvs,(e=>((0,a.uX)(),(0,a.Wv)(y,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,a.bF)(f,{label:"执行计划"},{default:(0,a.k6)((()=>[(0,a.bF)(C,{style:{width:"100%"},modelValue:u.cronTabData.plan,"onUpdate:modelValue":t[3]||(t[3]=e=>u.cronTabData.plan=e),placeholder:"请选择"},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.testPlans,(e=>((0,a.uX)(),(0,a.Wv)(y,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,a.bF)(f,{label:"是否开启"},{default:(0,a.k6)((()=>[(0,a.bF)(m,{modelValue:u.cronTabData.status,"onUpdate:modelValue":t[4]||(t[4]=e=>u.cronTabData.status=e),"active-color":"#13ce66","inactive-color":"#c3c3c3"},null,8,["modelValue"])])),_:1}),(0,a.bF)(f,{label:"定时规则"},{default:(0,a.k6)((()=>[(0,a.bF)(k,{modelValue:u.cronTabData.rule,"onUpdate:modelValue":t[5]||(t[5]=e=>u.cronTabData.rule=e),placeholder:"* * * * *"},null,8,["modelValue"]),(0,a.bF)(v,{gutter:20},{default:(0,a.k6)((()=>[(0,a.bF)(_,{span:14},{default:(0,a.k6)((()=>t[11]||(t[11]=[(0,a.Lk)("h5",null,"规则说明:",-1),(0,a.Lk)("div",{style:{"font-size":"12px","line-height":"16px"}},[(0,a.eW)("* * * * * "),(0,a.Lk)("span",{style:{color:"#909399"}},"分别表示 minute hour week day month ")],-1),(0,a.Lk)("div",{style:{"font-size":"12px","line-height":"16px"}},[(0,a.eW)("minute： "),(0,a.Lk)("span",{style:{color:"#909399"}},"表示分钟，可以是从0到59之间的任何整数。")],-1),(0,a.Lk)("div",{style:{"font-size":"12px","line-height":"16px"}},[(0,a.eW)("hour："),(0,a.Lk)("span",{style:{color:"#909399"}},"表示小时，可以是从0到23之间的任何整数。")],-1),(0,a.Lk)("div",{style:{"font-size":"12px","line-height":"16px"}},[(0,a.eW)("week："),(0,a.Lk)("span",{style:{color:"#909399"}},"表示星期几，可以是从0到7之间的任何整数，这里的0或7代表星期日。")],-1),(0,a.Lk)("div",{style:{"font-size":"12px","line-height":"16px"}},[(0,a.eW)("day："),(0,a.Lk)("span",{style:{color:"#909399"}},"表示日期，可以是从1到31之间的任何整数。")],-1),(0,a.Lk)("div",{style:{"font-size":"12px","line-height":"16px"}},[(0,a.eW)("month："),(0,a.Lk)("span",{style:{color:"#909399"}},"表示月份，可以是从1到12之间的任何整数。")],-1)]))),_:1,__:[11]}),(0,a.bF)(_,{span:10},{default:(0,a.k6)((()=>t[12]||(t[12]=[(0,a.Lk)("h5",null,"配置案例：",-1),(0,a.Lk)("div",{style:{"font-size":"12px","line-height":"16px"}},[(0,a.eW)("5 * * * * : "),(0,a.Lk)("span",{style:{color:"#909399"}},"每小时的第5分钟执行一次任务")],-1),(0,a.Lk)("div",{style:{"font-size":"12px","line-height":"16px"}},[(0,a.eW)("30 9 * * * : "),(0,a.Lk)("span",{style:{color:"#909399"}},"每天上午的 9:30 执行一次任务")],-1),(0,a.Lk)("div",{style:{"font-size":"12px","line-height":"16px"}},[(0,a.eW)("30 9 * 8 * : "),(0,a.Lk)("span",{style:{color:"#909399"}},"每月8号上午的9:30执行一次任务 ")],-1),(0,a.Lk)("div",{style:{"font-size":"12px","line-height":"16px"}},[(0,a.eW)("30 9 * 5 3 : "),(0,a.Lk)("span",{style:{color:"#909399"}}," 每年的3月5日9:30执行一次任务")],-1),(0,a.Lk)("div",{style:{"font-size":"12px","line-height":"16px"}},[(0,a.eW)("30 9 0 * * : "),(0,a.Lk)("span",{style:{color:"#909399"}},"每星期日的上午9:30执行一次任务")],-1)]))),_:1,__:[12]})])),_:1})])),_:1})])),_:1},8,["model"]),(0,a.Lk)("div",d,[(0,a.bF)(p,{onClick:t[6]||(t[6]=e=>u.dialogCron=!1),size:"small"},{default:(0,a.k6)((()=>t[13]||(t[13]=[(0,a.eW)("取 消")]))),_:1,__:[13]}),u.updateBtn?((0,a.uX)(),(0,a.Wv)(p,{key:0,type:"success",onClick:t[7]||(t[7]=e=>c.UpdateCron()),size:"small"},{default:(0,a.k6)((()=>t[14]||(t[14]=[(0,a.eW)("提交修改")]))),_:1,__:[14]})):((0,a.uX)(),(0,a.Wv)(p,{key:1,type:"success",onClick:t[8]||(t[8]=e=>c.createCron()),size:"small"},{default:(0,a.k6)((()=>t[15]||(t[15]=[(0,a.eW)("创 建")]))),_:1,__:[15]}))])])),_:1},8,["modelValue"])],64)}var u=l(782),c={data(){return{cronList:null,dialogCron:!1,updateBtn:!0,cronTabData:{name:"冒烟测试定期执行",rule:"* * * * *",status:!0,plan:null,env:null},loading:!1}},computed:{...(0,u.aH)(["pro","testEnvs","testPlans"])},methods:{...(0,u.i0)(["getAllEnvs","getAllPlan"]),async refreshData(){this.loading=!0,await Promise.all([this.getAllEnvs(),this.getAllPlan()]),this.loading=!1},async getAllCron(){const e=await this.$api.getCrons(this.pro.id);200===e.status&&(this.cronList=e.data)},delCron(e){this.$confirm("此操作将永久删除该定时任务, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const t=await this.$api.delCron(e);204===t.status&&(this.$message({type:"success",message:"删除成功!"}),this.getAllCron())})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},async switchCronStatus(e){const t=await this.$api.updateCron(e.id,e);200===t.status?1==e.status?this.$message({type:"success",message:"定时运行已开启",duration:1e3}):this.$message({type:"warning",message:"定时运行已关闭",duration:1e3}):this.$message({type:"error",message:"修改状态失败",duration:1e3})},async createCron(){const e={project:this.pro.id,...this.cronTabData},t=await this.$api.createCron(e);201===t.status?(this.$message({type:"success",message:"定时任务添加成功",duration:1e3}),this.dialogCron=!1,this.getAllCron()):this.$message({type:"error",message:"定时任务添加失败:"+t.data.name,duration:1e3})},showUpdateCronDlg(e){this.cronTabData={...e},this.dialogCron=!0,this.updateBtn=!0},async UpdateCron(){const e=await this.$api.updateCron(this.cronTabData.id,this.cronTabData);200===e.status&&(this.$message({type:"success",message:"修改成功",duration:1e3}),this.dialogCron=!1,this.getAllCron())}},created(){this.getAllCron(),this.getAllEnvs(),this.getAllPlan()}},p=l(1241);const h=(0,p.A)(c,[["render",r]]);var m=h}}]);
//# sourceMappingURL=group-user.7d0f9a3c.js.map