"use strict";(self["webpackChunkapi_test_platform"]=self["webpackChunkapi_test_platform"]||[]).push([[187],{7483:function(e,t,n){n.r(t),n.d(t,{default:function(){return Zt}});var o=n(6768),i=n(4232);const a={class:"list_box"},r={key:0,class:"scene-data-box"},l={class:"el-icon-upload",style:{color:"#009A71","font-weight":"bold","font-size":"14px"}},s={style:{"font-weight":"bold","font-size":"14px"}},c={style:{padding:"20px"}},d={class:"custom-tree-node"},u={key:0},h={style:{color:"#00AA7F"}},p={key:1},f={style:{color:"#00AA7F"}},g={class:"custom-tree-node"},v={key:0},m={style:{color:"#00AA7F"}},b={key:1},y={style:{color:"#00AA7F"}},w={class:"add-btns",style:{"text-align":"center"}};function _(e,t,n,_,S,k){const D=(0,o.g2)("el-button"),E=(0,o.g2)("HelpFilled"),C=(0,o.g2)("el-icon"),T=(0,o.g2)("el-menu-item"),x=(0,o.g2)("el-menu"),F=(0,o.g2)("el-col"),I=(0,o.g2)("el-divider"),A=(0,o.g2)("el-input"),O=(0,o.g2)("el-row"),M=(0,o.g2)("el-table-column"),N=(0,o.g2)("el-table"),P=(0,o.g2)("el-scrollbar"),R=(0,o.g2)("el-empty"),X=(0,o.g2)("el-descriptions-item"),L=(0,o.g2)("el-descriptions"),Y=(0,o.g2)("caseResult"),B=(0,o.g2)("el-tag"),W=(0,o.g2)("el-drawer"),j=(0,o.g2)("EditCase"),H=(0,o.g2)("Paperclip"),z=(0,o.g2)("Link"),V=(0,o.g2)("el-tree"),$=(0,o.g2)("el-tab-pane"),U=(0,o.g2)("el-tabs"),G=(0,o.g2)("el-tooltip"),Q=(0,o.g2)("el-affix"),q=(0,o.gN)("loading");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(O,{gutter:10},{default:(0,o.k6)((()=>[(0,o.bF)(F,{span:4},{default:(0,o.k6)((()=>[(0,o.Lk)("div",a,[t[9]||(t[9]=(0,o.Lk)("div",{class:"title"},"测试场景",-1)),(0,o.bF)(D,{onClick:k.addScene,icon:"Plus",plain:"",type:"success",style:{width:"100%"},loading:S.addingScene},{default:(0,o.k6)((()=>t[8]||(t[8]=[(0,o.eW)(" 添加测试场景 ")]))),_:1,__:[8]},8,["onClick","loading"]),(0,o.bF)(x,{"default-active":S.active,class:"el-menu-vertical-demo","active-text-color":"#00aa7f","text-color":"#000000",style:{background:"none",border:"none"}},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.testScenes,(e=>((0,o.uX)(),(0,o.Wv)(T,{key:e.id,index:e.id.toString(),onClick:t=>k.handleSceneClick(e),style:{height:"35px","line-height":"35px"},disabled:S.loading},{default:(0,o.k6)((()=>[(0,o.bF)(C,null,{default:(0,o.k6)((()=>[(0,o.bF)(E)])),_:1}),(0,o.Lk)("span",null,(0,i.v_)(e.name),1)])),_:2},1032,["index","onClick","disabled"])))),128))])),_:1},8,["default-active"])])])),_:1}),(0,o.bF)(F,{span:20},{default:(0,o.k6)((()=>[(0,o.bF)(P,{height:"calc(100vh - 68px)"},{default:(0,o.k6)((()=>[null!==S.steps?(0,o.bo)(((0,o.uX)(),(0,o.CE)("div",r,[(0,o.bF)(I,{"content-position":"left"},{default:(0,o.k6)((()=>t[10]||(t[10]=[(0,o.Lk)("b",null,"场景信息",-1)]))),_:1,__:[10]}),(0,o.bF)(O,{gutter:5,style:{"margin-bottom":"20px"}},{default:(0,o.k6)((()=>[(0,o.bF)(F,{span:12},{default:(0,o.k6)((()=>[(0,o.bF)(A,{modelValue:S.sceneInfo.name,"onUpdate:modelValue":t[0]||(t[0]=e=>S.sceneInfo.name=e),size:"small"},{prepend:(0,o.k6)((()=>t[11]||(t[11]=[(0,o.eW)("场景名称")]))),append:(0,o.k6)((()=>[(0,o.bF)(D,{onClick:k.saveScene,plain:"",icon:"CircleCheck",type:"success",loading:S.saving},{default:(0,o.k6)((()=>t[12]||(t[12]=[(0,o.eW)(" 保存 ")]))),_:1,__:[12]},8,["onClick","loading"])])),_:1},8,["modelValue"])])),_:1}),(0,o.bF)(F,{span:12,style:{"text-align":"right"}},{default:(0,o.k6)((()=>[(0,o.bF)(D,{onClick:k.runScene,plain:"",type:"success",icon:"Promotion",disabled:!e.envId,loading:S.running},{default:(0,o.k6)((()=>t[13]||(t[13]=[(0,o.eW)(" 运行 ")]))),_:1,__:[13]},8,["onClick","disabled","loading"]),(0,o.bF)(D,{onClick:k.deleteScene,plain:"",icon:"Delete",type:"danger",loading:S.deleting},{default:(0,o.k6)((()=>t[14]||(t[14]=[(0,o.eW)(" 删除 ")]))),_:1,__:[14]},8,["onClick","loading"])])),_:1})])),_:1}),(0,o.bF)(I,{"content-position":"left"},{default:(0,o.k6)((()=>t[15]||(t[15]=[(0,o.Lk)("b",null,"执行步骤",-1)]))),_:1,__:[15]}),(0,o.bF)(P,{height:"calc(100vh - 210px)"},{default:(0,o.k6)((()=>[(0,o.bo)(((0,o.uX)(),(0,o.Wv)(N,{data:S.steps,"row-key":"id",style:{width:"100%","margin-bottom":"10px"},"show-header":!1},{default:(0,o.k6)((()=>[(0,o.bF)(M,null,{default:(0,o.k6)((e=>[(0,o.Lk)("span",l,(0,i.v_)("步骤"+(e.$index+1)+": "),1),(0,o.Lk)("span",s,(0,i.v_)(e.row.stepInfo.title),1)])),_:1}),(0,o.bF)(M,{width:"200px"},{default:(0,o.k6)((e=>[(0,o.bF)(D,{onClick:t=>k.clickEditStep(e.row.stepInfo),plain:"",type:"success",icon:"Edit"},{default:(0,o.k6)((()=>t[16]||(t[16]=[(0,o.eW)(" 编辑 ")]))),_:2,__:[16]},1032,["onClick"]),(0,o.bF)(D,{onClick:t=>k.clickDelete(e.row.id),plain:"",type:"danger",icon:"Delete"},{default:(0,o.k6)((()=>t[17]||(t[17]=[(0,o.eW)(" 删除 ")]))),_:2,__:[17]},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[q,S.loadingSteps]]),(0,o.bF)(D,{onClick:t[1]||(t[1]=e=>S.addStepDlg=!0),plain:"",icon:"Plus",type:"success"},{default:(0,o.k6)((()=>t[18]||(t[18]=[(0,o.eW)("新增步骤")]))),_:1,__:[18]})])),_:1})])),[[q,S.loading]]):((0,o.uX)(),(0,o.Wv)(R,{key:1,description:0===e.testScenes.length?"请添加一个测试场景":"请选择一个测试场景"},null,8,["description"]))])),_:1})])),_:1})])),_:1}),(0,o.bF)(W,{modelValue:S.ResultDlg,"onUpdate:modelValue":t[2]||(t[2]=e=>S.ResultDlg=e),"with-header":!1,size:"60%","before-close":k.handleDrawerClose},{default:(0,o.k6)((()=>[(0,o.Lk)("div",c,[(0,o.bF)(L,{title:"执行结果",border:"",column:4},{default:(0,o.k6)((()=>[(0,o.bF)(X,{label:"总数"},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(S.runSceneResult.all),1)])),_:1}),(0,o.bF)(X,{label:"通过"},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(S.runSceneResult.success),1)])),_:1}),(0,o.bF)(X,{label:"失败"},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(S.runSceneResult.fail),1)])),_:1}),(0,o.bF)(X,{label:"错误"},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(S.runSceneResult.error),1)])),_:1})])),_:1}),t[19]||(t[19]=(0,o.Lk)("div",{style:{height:"40px","line-height":"40px"}},[(0,o.Lk)("b",null,"执行详情")],-1)),(0,o.bF)(P,{height:"calc(100vh - 180px)"},{default:(0,o.k6)((()=>[(0,o.bF)(N,{data:S.runSceneResult.cases,style:{width:"100%"}},{default:(0,o.k6)((()=>[(0,o.bF)(M,{type:"expand"},{default:(0,o.k6)((e=>[(0,o.bF)(Y,{result:e.row},null,8,["result"])])),_:1}),(0,o.bF)(M,{label:"用例名",prop:"name"}),(0,o.bF)(M,{label:"请求方法",prop:"method"}),(0,o.bF)(M,{label:"响应状态码",prop:"status_cede"}),(0,o.bF)(M,{label:"执行结果",prop:"state","min-width":"40px"},{default:(0,o.k6)((e=>[(0,o.bF)(B,{type:"成功"===e.row.state?"success":"danger"},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(e.row.state),1)])),_:2},1032,["type"])])),_:1})])),_:1},8,["data"])])),_:1})])])),_:1},8,["modelValue","before-close"]),(0,o.bF)(W,{modelValue:S.editStepDlg,"onUpdate:modelValue":t[4]||(t[4]=e=>S.editStepDlg=e),"with-header":!1,size:"65%","before-close":k.handleEditDrawerClose},{default:(0,o.k6)((()=>[(0,o.bF)(j,{editCase:S.editCase,style:{padding:"0 10px","min-height":"500px"},onSaved:k.handleCaseSaved,onCancel:t[3]||(t[3]=e=>S.editStepDlg=!1)},null,8,["editCase","onSaved"])])),_:1},8,["modelValue","before-close"]),(0,o.bF)(W,{modelValue:S.addStepDlg,"onUpdate:modelValue":t[7]||(t[7]=e=>S.addStepDlg=e),"with-header":!1,"before-close":k.handleAddStepClose},{default:(0,o.k6)((()=>[(0,o.bF)(U,{stretch:"",modelValue:S.activeTab,"onUpdate:modelValue":t[5]||(t[5]=e=>S.activeTab=e)},{default:(0,o.k6)((()=>[(0,o.bF)($,{label:"内部接口",name:"internal"},{default:(0,o.k6)((()=>[(0,o.bF)(V,{ref:"treeM1",data:e.inters1,"show-checkbox":"",props:S.addTreeProps,"node-key":"id","default-expand-all":"","highlight-current":"","filter-node-method":k.filterNode},{default:(0,o.k6)((({node:e,data:n})=>[(0,o.Lk)("span",d,[n.name?((0,o.uX)(),(0,o.CE)("div",u,[(0,o.Lk)("b",h,[(0,o.bF)(C,null,{default:(0,o.k6)((()=>[(0,o.bF)(H)])),_:1}),(0,o.Lk)("span",null,(0,i.v_)(n.name),1)])])):(0,o.Q3)("",!0),n.title?((0,o.uX)(),(0,o.CE)("div",p,[(0,o.Lk)("b",f,[(0,o.bF)(C,null,{default:(0,o.k6)((()=>[(0,o.bF)(z)])),_:1}),t[20]||(t[20]=(0,o.Lk)("span",null,"用例",-1))]),(0,o.Lk)("span",null,": "+(0,i.v_)(n.title),1)])):(0,o.Q3)("",!0)])])),_:1},8,["data","props","filter-node-method"])])),_:1}),(0,o.bF)($,{label:"外部接口",name:"external"},{default:(0,o.k6)((()=>[(0,o.bF)(V,{ref:"treeM2",data:e.inters2,"show-checkbox":"",props:S.addTreeProps,"node-key":"id","default-expand-all":"","expand-on-click-node":!1,"filter-node-method":k.filterNode},{default:(0,o.k6)((({node:e,data:n})=>[(0,o.Lk)("span",g,[n.name?((0,o.uX)(),(0,o.CE)("div",v,[(0,o.Lk)("b",m,[(0,o.bF)(C,null,{default:(0,o.k6)((()=>[(0,o.bF)(H)])),_:1}),(0,o.Lk)("span",null,(0,i.v_)(n.name),1)])])):(0,o.Q3)("",!0),n.title?((0,o.uX)(),(0,o.CE)("div",b,[(0,o.Lk)("b",y,[(0,o.bF)(C,null,{default:(0,o.k6)((()=>[(0,o.bF)(z)])),_:1}),t[21]||(t[21]=(0,o.Lk)("span",null,"用例",-1))]),(0,o.Lk)("span",null,": "+(0,i.v_)(n.title),1)])):(0,o.Q3)("",!0)])])),_:1},8,["data","props","filter-node-method"])])),_:1})])),_:1},8,["modelValue"]),(0,o.bF)(Q,{position:"bottom",offset:40},{default:(0,o.k6)((()=>[(0,o.Lk)("div",w,[(0,o.bF)(G,{content:"将选择的用例加入到测试场景中",placement:"top-start"},{default:(0,o.k6)((()=>[(0,o.bF)(D,{plain:"",type:"success",size:"small",onClick:k.confirmAddToScene,loading:S.addingSteps},{default:(0,o.k6)((()=>t[22]||(t[22]=[(0,o.eW)(" 确认添加 ")]))),_:1,__:[22]},8,["onClick","loading"])])),_:1}),(0,o.bF)(G,{content:"关闭当前窗口",placement:"top-start"},{default:(0,o.k6)((()=>[(0,o.bF)(D,{plain:"",type:"danger",size:"small",onClick:t[6]||(t[6]=e=>S.addStepDlg=!1)},{default:(0,o.k6)((()=>t[23]||(t[23]=[(0,o.eW)(" 关闭窗口 ")]))),_:1,__:[23]})])),_:1})])])),_:1})])),_:1},8,["modelValue","before-close"])],64)}n(8111),n(7588),n(1701);var S=n(782),k=n(1219),D=n(2933),E=n(3851);n(4114),n(2489),n(3579),n(1806);
/**!
 * Sortable 1.15.6
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */
function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){F(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e){return x="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}function F(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I(){return I=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},I.apply(this,arguments)}function A(e,t){if(null==e)return{};var n,o,i={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(i[n]=e[n]);return i}function O(e,t){if(null==e)return{};var n,o,i=A(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var M="1.15.6";function N(e){if("undefined"!==typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var P=N(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),R=N(/Edge/i),X=N(/firefox/i),L=N(/safari/i)&&!N(/chrome/i)&&!N(/android/i),Y=N(/iP(ad|od|hone)/i),B=N(/chrome/i)&&N(/android/i),W={capture:!1,passive:!1};function j(e,t,n){e.addEventListener(t,n,!P&&W)}function H(e,t,n){e.removeEventListener(t,n,!P&&W)}function z(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(n){return!1}return!1}}function V(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function $(e,t,n,o){if(e){n=n||document;do{if(null!=t&&(">"===t[0]?e.parentNode===n&&z(e,t):z(e,t))||o&&e===n)return e;if(e===n)break}while(e=V(e))}return null}var U,G=/\s+/g;function Q(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var o=(" "+e.className+" ").replace(G," ").replace(" "+t+" "," ");e.className=(o+(n?" "+t:"")).replace(G," ")}}function q(e,t,n){var o=e&&e.style;if(o){if(void 0===n)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),void 0===t?n:n[t];t in o||-1!==t.indexOf("webkit")||(t="-webkit-"+t),o[t]=n+("string"===typeof n?"":"px")}}function K(e,t){var n="";if("string"===typeof e)n=e;else do{var o=q(e,"transform");o&&"none"!==o&&(n=o+" "+n)}while(!t&&(e=e.parentNode));var i=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return i&&new i(n)}function Z(e,t,n){if(e){var o=e.getElementsByTagName(t),i=0,a=o.length;if(n)for(;i<a;i++)n(o[i],i);return o}return[]}function J(){var e=document.scrollingElement;return e||document.documentElement}function ee(e,t,n,o,i){if(e.getBoundingClientRect||e===window){var a,r,l,s,c,d,u;if(e!==window&&e.parentNode&&e!==J()?(a=e.getBoundingClientRect(),r=a.top,l=a.left,s=a.bottom,c=a.right,d=a.height,u=a.width):(r=0,l=0,s=window.innerHeight,c=window.innerWidth,d=window.innerHeight,u=window.innerWidth),(t||n)&&e!==window&&(i=i||e.parentNode,!P))do{if(i&&i.getBoundingClientRect&&("none"!==q(i,"transform")||n&&"static"!==q(i,"position"))){var h=i.getBoundingClientRect();r-=h.top+parseInt(q(i,"border-top-width")),l-=h.left+parseInt(q(i,"border-left-width")),s=r+a.height,c=l+a.width;break}}while(i=i.parentNode);if(o&&e!==window){var p=K(i||e),f=p&&p.a,g=p&&p.d;p&&(r/=g,l/=f,u/=f,d/=g,s=r+d,c=l+u)}return{top:r,left:l,bottom:s,right:c,width:u,height:d}}}function te(e,t,n){var o=le(e,!0),i=ee(e)[t];while(o){var a=ee(o)[n],r=void 0;if(r="top"===n||"left"===n?i>=a:i<=a,!r)return o;if(o===J())break;o=le(o,!1)}return!1}function ne(e,t,n,o){var i=0,a=0,r=e.children;while(a<r.length){if("none"!==r[a].style.display&&r[a]!==bt.ghost&&(o||r[a]!==bt.dragged)&&$(r[a],n.draggable,e,!1)){if(i===t)return r[a];i++}a++}return null}function oe(e,t){var n=e.lastElementChild;while(n&&(n===bt.ghost||"none"===q(n,"display")||t&&!z(n,t)))n=n.previousElementSibling;return n||null}function ie(e,t){var n=0;if(!e||!e.parentNode)return-1;while(e=e.previousElementSibling)"TEMPLATE"===e.nodeName.toUpperCase()||e===bt.clone||t&&!z(e,t)||n++;return n}function ae(e){var t=0,n=0,o=J();if(e)do{var i=K(e),a=i.a,r=i.d;t+=e.scrollLeft*a,n+=e.scrollTop*r}while(e!==o&&(e=e.parentNode));return[t,n]}function re(e,t){for(var n in e)if(e.hasOwnProperty(n))for(var o in t)if(t.hasOwnProperty(o)&&t[o]===e[n][o])return Number(n);return-1}function le(e,t){if(!e||!e.getBoundingClientRect)return J();var n=e,o=!1;do{if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var i=q(n);if(n.clientWidth<n.scrollWidth&&("auto"==i.overflowX||"scroll"==i.overflowX)||n.clientHeight<n.scrollHeight&&("auto"==i.overflowY||"scroll"==i.overflowY)){if(!n.getBoundingClientRect||n===document.body)return J();if(o||t)return n;o=!0}}}while(n=n.parentNode);return J()}function se(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function ce(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function de(e,t){return function(){if(!U){var n=arguments,o=this;1===n.length?e.call(o,n[0]):e.apply(o,n),U=setTimeout((function(){U=void 0}),t)}}}function ue(){clearTimeout(U),U=void 0}function he(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function pe(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}function fe(e,t,n){var o={};return Array.from(e.children).forEach((function(i){var a,r,l,s;if($(i,t.draggable,e,!1)&&!i.animated&&i!==n){var c=ee(i);o.left=Math.min(null!==(a=o.left)&&void 0!==a?a:1/0,c.left),o.top=Math.min(null!==(r=o.top)&&void 0!==r?r:1/0,c.top),o.right=Math.max(null!==(l=o.right)&&void 0!==l?l:-1/0,c.right),o.bottom=Math.max(null!==(s=o.bottom)&&void 0!==s?s:-1/0,c.bottom)}})),o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}var ge="Sortable"+(new Date).getTime();function ve(){var e,t=[];return{captureAnimationState:function(){if(t=[],this.options.animation){var e=[].slice.call(this.el.children);e.forEach((function(e){if("none"!==q(e,"display")&&e!==bt.ghost){t.push({target:e,rect:ee(e)});var n=T({},t[t.length-1].rect);if(e.thisAnimationDuration){var o=K(e,!0);o&&(n.top-=o.f,n.left-=o.e)}e.fromRect=n}}))}},addAnimationState:function(e){t.push(e)},removeAnimationState:function(e){t.splice(re(t,{target:e}),1)},animateAll:function(n){var o=this;if(!this.options.animation)return clearTimeout(e),void("function"===typeof n&&n());var i=!1,a=0;t.forEach((function(e){var t=0,n=e.target,r=n.fromRect,l=ee(n),s=n.prevFromRect,c=n.prevToRect,d=e.rect,u=K(n,!0);u&&(l.top-=u.f,l.left-=u.e),n.toRect=l,n.thisAnimationDuration&&ce(s,l)&&!ce(r,l)&&(d.top-l.top)/(d.left-l.left)===(r.top-l.top)/(r.left-l.left)&&(t=be(d,s,c,o.options)),ce(l,r)||(n.prevFromRect=r,n.prevToRect=l,t||(t=o.options.animation),o.animate(n,d,l,t)),t&&(i=!0,a=Math.max(a,t),clearTimeout(n.animationResetTimer),n.animationResetTimer=setTimeout((function(){n.animationTime=0,n.prevFromRect=null,n.fromRect=null,n.prevToRect=null,n.thisAnimationDuration=null}),t),n.thisAnimationDuration=t)})),clearTimeout(e),i?e=setTimeout((function(){"function"===typeof n&&n()}),a):"function"===typeof n&&n(),t=[]},animate:function(e,t,n,o){if(o){q(e,"transition",""),q(e,"transform","");var i=K(this.el),a=i&&i.a,r=i&&i.d,l=(t.left-n.left)/(a||1),s=(t.top-n.top)/(r||1);e.animatingX=!!l,e.animatingY=!!s,q(e,"transform","translate3d("+l+"px,"+s+"px,0)"),this.forRepaintDummy=me(e),q(e,"transition","transform "+o+"ms"+(this.options.easing?" "+this.options.easing:"")),q(e,"transform","translate3d(0,0,0)"),"number"===typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout((function(){q(e,"transition",""),q(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1}),o)}}}}function me(e){return e.offsetWidth}function be(e,t,n,o){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))*o.animation}var ye=[],we={initializeByDefault:!0},_e={mount:function(e){for(var t in we)we.hasOwnProperty(t)&&!(t in e)&&(e[t]=we[t]);ye.forEach((function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")})),ye.push(e)},pluginEvent:function(e,t,n){var o=this;this.eventCanceled=!1,n.cancel=function(){o.eventCanceled=!0};var i=e+"Global";ye.forEach((function(o){t[o.pluginName]&&(t[o.pluginName][i]&&t[o.pluginName][i](T({sortable:t},n)),t.options[o.pluginName]&&t[o.pluginName][e]&&t[o.pluginName][e](T({sortable:t},n)))}))},initializePlugins:function(e,t,n,o){for(var i in ye.forEach((function(o){var i=o.pluginName;if(e.options[i]||o.initializeByDefault){var a=new o(e,t,e.options);a.sortable=e,a.options=e.options,e[i]=a,I(n,a.defaults)}})),e.options)if(e.options.hasOwnProperty(i)){var a=this.modifyOption(e,i,e.options[i]);"undefined"!==typeof a&&(e.options[i]=a)}},getEventProperties:function(e,t){var n={};return ye.forEach((function(o){"function"===typeof o.eventProperties&&I(n,o.eventProperties.call(t[o.pluginName],e))})),n},modifyOption:function(e,t,n){var o;return ye.forEach((function(i){e[i.pluginName]&&i.optionListeners&&"function"===typeof i.optionListeners[t]&&(o=i.optionListeners[t].call(e[i.pluginName],n))})),o}};function Se(e){var t=e.sortable,n=e.rootEl,o=e.name,i=e.targetEl,a=e.cloneEl,r=e.toEl,l=e.fromEl,s=e.oldIndex,c=e.newIndex,d=e.oldDraggableIndex,u=e.newDraggableIndex,h=e.originalEvent,p=e.putSortable,f=e.extraEventProperties;if(t=t||n&&n[ge],t){var g,v=t.options,m="on"+o.charAt(0).toUpperCase()+o.substr(1);!window.CustomEvent||P||R?(g=document.createEvent("Event"),g.initEvent(o,!0,!0)):g=new CustomEvent(o,{bubbles:!0,cancelable:!0}),g.to=r||n,g.from=l||n,g.item=i||n,g.clone=a,g.oldIndex=s,g.newIndex=c,g.oldDraggableIndex=d,g.newDraggableIndex=u,g.originalEvent=h,g.pullMode=p?p.lastPutMode:void 0;var b=T(T({},f),_e.getEventProperties(o,t));for(var y in b)g[y]=b[y];n&&n.dispatchEvent(g),v[m]&&v[m].call(t,g)}}var ke=["evt"],De=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=n.evt,i=O(n,ke);_e.pluginEvent.bind(bt)(e,t,T({dragEl:Ce,parentEl:Te,ghostEl:xe,rootEl:Fe,nextEl:Ie,lastDownEl:Ae,cloneEl:Oe,cloneHidden:Me,dragStarted:$e,putSortable:Ye,activeSortable:bt.active,originalEvent:o,oldIndex:Ne,oldDraggableIndex:Re,newIndex:Pe,newDraggableIndex:Xe,hideGhostForTarget:ft,unhideGhostForTarget:gt,cloneNowHidden:function(){Me=!0},cloneNowShown:function(){Me=!1},dispatchSortableEvent:function(e){Ee({sortable:t,name:e,originalEvent:o})}},i))};function Ee(e){Se(T({putSortable:Ye,cloneEl:Oe,targetEl:Ce,rootEl:Fe,oldIndex:Ne,oldDraggableIndex:Re,newIndex:Pe,newDraggableIndex:Xe},e))}var Ce,Te,xe,Fe,Ie,Ae,Oe,Me,Ne,Pe,Re,Xe,Le,Ye,Be,We,je,He,ze,Ve,$e,Ue,Ge,Qe,qe,Ke=!1,Ze=!1,Je=[],et=!1,tt=!1,nt=[],ot=!1,it=[],at="undefined"!==typeof document,rt=Y,lt=R||P?"cssFloat":"float",st=at&&!B&&!Y&&"draggable"in document.createElement("div"),ct=function(){if(at){if(P)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),dt=function(e,t){var n=q(e),o=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),i=ne(e,0,t),a=ne(e,1,t),r=i&&q(i),l=a&&q(a),s=r&&parseInt(r.marginLeft)+parseInt(r.marginRight)+ee(i).width,c=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+ee(a).width;if("flex"===n.display)return"column"===n.flexDirection||"column-reverse"===n.flexDirection?"vertical":"horizontal";if("grid"===n.display)return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&r["float"]&&"none"!==r["float"]){var d="left"===r["float"]?"left":"right";return!a||"both"!==l.clear&&l.clear!==d?"horizontal":"vertical"}return i&&("block"===r.display||"flex"===r.display||"table"===r.display||"grid"===r.display||s>=o&&"none"===n[lt]||a&&"none"===n[lt]&&s+c>o)?"vertical":"horizontal"},ut=function(e,t,n){var o=n?e.left:e.top,i=n?e.right:e.bottom,a=n?e.width:e.height,r=n?t.left:t.top,l=n?t.right:t.bottom,s=n?t.width:t.height;return o===r||i===l||o+a/2===r+s/2},ht=function(e,t){var n;return Je.some((function(o){var i=o[ge].options.emptyInsertThreshold;if(i&&!oe(o)){var a=ee(o),r=e>=a.left-i&&e<=a.right+i,l=t>=a.top-i&&t<=a.bottom+i;return r&&l?n=o:void 0}})),n},pt=function(e){function t(e,n){return function(o,i,a,r){var l=o.options.group.name&&i.options.group.name&&o.options.group.name===i.options.group.name;if(null==e&&(n||l))return!0;if(null==e||!1===e)return!1;if(n&&"clone"===e)return e;if("function"===typeof e)return t(e(o,i,a,r),n)(o,i,a,r);var s=(n?o:i).options.group.name;return!0===e||"string"===typeof e&&e===s||e.join&&e.indexOf(s)>-1}}var n={},o=e.group;o&&"object"==x(o)||(o={name:o}),n.name=o.name,n.checkPull=t(o.pull,!0),n.checkPut=t(o.put),n.revertClone=o.revertClone,e.group=n},ft=function(){!ct&&xe&&q(xe,"display","none")},gt=function(){!ct&&xe&&q(xe,"display","")};at&&!B&&document.addEventListener("click",(function(e){if(Ze)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Ze=!1,!1}),!0);var vt=function(e){if(Ce){e=e.touches?e.touches[0]:e;var t=ht(e.clientX,e.clientY);if(t){var n={};for(var o in e)e.hasOwnProperty(o)&&(n[o]=e[o]);n.target=n.rootEl=t,n.preventDefault=void 0,n.stopPropagation=void 0,t[ge]._onDragOver(n)}}},mt=function(e){Ce&&Ce.parentNode[ge]._isOutsideThisEl(e.target)};function bt(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=I({},t),e[ge]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return dt(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==bt.supportPointer&&"PointerEvent"in window&&(!L||Y),emptyInsertThreshold:5};for(var o in _e.initializePlugins(this,e,n),n)!(o in t)&&(t[o]=n[o]);for(var i in pt(t),this)"_"===i.charAt(0)&&"function"===typeof this[i]&&(this[i]=this[i].bind(this));this.nativeDraggable=!t.forceFallback&&st,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?j(e,"pointerdown",this._onTapStart):(j(e,"mousedown",this._onTapStart),j(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(j(e,"dragover",this),j(e,"dragenter",this)),Je.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),I(this,ve())}function yt(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function wt(e,t,n,o,i,a,r,l){var s,c,d=e[ge],u=d.options.onMove;return!window.CustomEvent||P||R?(s=document.createEvent("Event"),s.initEvent("move",!0,!0)):s=new CustomEvent("move",{bubbles:!0,cancelable:!0}),s.to=t,s.from=e,s.dragged=n,s.draggedRect=o,s.related=i||t,s.relatedRect=a||ee(t),s.willInsertAfter=l,s.originalEvent=r,e.dispatchEvent(s),u&&(c=u.call(d,s,r)),c}function _t(e){e.draggable=!1}function St(){ot=!1}function kt(e,t,n){var o=ee(ne(n.el,0,n.options,!0)),i=fe(n.el,n.options,xe),a=10;return t?e.clientX<i.left-a||e.clientY<o.top&&e.clientX<o.right:e.clientY<i.top-a||e.clientY<o.bottom&&e.clientX<o.left}function Dt(e,t,n){var o=ee(oe(n.el,n.options.draggable)),i=fe(n.el,n.options,xe),a=10;return t?e.clientX>i.right+a||e.clientY>o.bottom&&e.clientX>o.left:e.clientY>i.bottom+a||e.clientX>o.right&&e.clientY>o.top}function Et(e,t,n,o,i,a,r,l){var s=o?e.clientY:e.clientX,c=o?n.height:n.width,d=o?n.top:n.left,u=o?n.bottom:n.right,h=!1;if(!r)if(l&&Qe<c*i){if(!et&&(1===Ge?s>d+c*a/2:s<u-c*a/2)&&(et=!0),et)h=!0;else if(1===Ge?s<d+Qe:s>u-Qe)return-Ge}else if(s>d+c*(1-i)/2&&s<u-c*(1-i)/2)return Ct(t);return h=h||r,h&&(s<d+c*a/2||s>u-c*a/2)?s>d+c/2?1:-1:0}function Ct(e){return ie(Ce)<ie(e)?1:-1}function Tt(e){var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,o=0;while(n--)o+=t.charCodeAt(n);return o.toString(36)}function xt(e){it.length=0;var t=e.getElementsByTagName("input"),n=t.length;while(n--){var o=t[n];o.checked&&it.push(o)}}function Ft(e){return setTimeout(e,0)}function It(e){return clearTimeout(e)}bt.prototype={constructor:bt,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(Ue=null)},_getDirection:function(e,t){return"function"===typeof this.options.direction?this.options.direction.call(this,e,t,Ce):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,n=this.el,o=this.options,i=o.preventOnFilter,a=e.type,r=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,l=(r||e).target,s=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||l,c=o.filter;if(xt(n),!Ce&&!(/mousedown|pointerdown/.test(a)&&0!==e.button||o.disabled)&&!s.isContentEditable&&(this.nativeDraggable||!L||!l||"SELECT"!==l.tagName.toUpperCase())&&(l=$(l,o.draggable,n,!1),(!l||!l.animated)&&Ae!==l)){if(Ne=ie(l),Re=ie(l,o.draggable),"function"===typeof c){if(c.call(this,e,l,this))return Ee({sortable:t,rootEl:s,name:"filter",targetEl:l,toEl:n,fromEl:n}),De("filter",t,{evt:e}),void(i&&e.preventDefault())}else if(c&&(c=c.split(",").some((function(o){if(o=$(s,o.trim(),n,!1),o)return Ee({sortable:t,rootEl:o,name:"filter",targetEl:l,fromEl:n,toEl:n}),De("filter",t,{evt:e}),!0})),c))return void(i&&e.preventDefault());o.handle&&!$(s,o.handle,n,!1)||this._prepareDragStart(e,r,l)}}},_prepareDragStart:function(e,t,n){var o,i=this,a=i.el,r=i.options,l=a.ownerDocument;if(n&&!Ce&&n.parentNode===a){var s=ee(n);if(Fe=a,Ce=n,Te=Ce.parentNode,Ie=Ce.nextSibling,Ae=n,Le=r.group,bt.dragged=Ce,Be={target:Ce,clientX:(t||e).clientX,clientY:(t||e).clientY},ze=Be.clientX-s.left,Ve=Be.clientY-s.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,Ce.style["will-change"]="all",o=function(){De("delayEnded",i,{evt:e}),bt.eventCanceled?i._onDrop():(i._disableDelayedDragEvents(),!X&&i.nativeDraggable&&(Ce.draggable=!0),i._triggerDragStart(e,t),Ee({sortable:i,name:"choose",originalEvent:e}),Q(Ce,r.chosenClass,!0))},r.ignore.split(",").forEach((function(e){Z(Ce,e.trim(),_t)})),j(l,"dragover",vt),j(l,"mousemove",vt),j(l,"touchmove",vt),r.supportPointer?(j(l,"pointerup",i._onDrop),!this.nativeDraggable&&j(l,"pointercancel",i._onDrop)):(j(l,"mouseup",i._onDrop),j(l,"touchend",i._onDrop),j(l,"touchcancel",i._onDrop)),X&&this.nativeDraggable&&(this.options.touchStartThreshold=4,Ce.draggable=!0),De("delayStart",this,{evt:e}),!r.delay||r.delayOnTouchOnly&&!t||this.nativeDraggable&&(R||P))o();else{if(bt.eventCanceled)return void this._onDrop();r.supportPointer?(j(l,"pointerup",i._disableDelayedDrag),j(l,"pointercancel",i._disableDelayedDrag)):(j(l,"mouseup",i._disableDelayedDrag),j(l,"touchend",i._disableDelayedDrag),j(l,"touchcancel",i._disableDelayedDrag)),j(l,"mousemove",i._delayedDragTouchMoveHandler),j(l,"touchmove",i._delayedDragTouchMoveHandler),r.supportPointer&&j(l,"pointermove",i._delayedDragTouchMoveHandler),i._dragStartTimer=setTimeout(o,r.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){Ce&&_t(Ce),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;H(e,"mouseup",this._disableDelayedDrag),H(e,"touchend",this._disableDelayedDrag),H(e,"touchcancel",this._disableDelayedDrag),H(e,"pointerup",this._disableDelayedDrag),H(e,"pointercancel",this._disableDelayedDrag),H(e,"mousemove",this._delayedDragTouchMoveHandler),H(e,"touchmove",this._delayedDragTouchMoveHandler),H(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?j(document,"pointermove",this._onTouchMove):j(document,t?"touchmove":"mousemove",this._onTouchMove):(j(Ce,"dragend",this),j(Fe,"dragstart",this._onDragStart));try{document.selection?Ft((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(n){}},_dragStarted:function(e,t){if(Ke=!1,Fe&&Ce){De("dragStarted",this,{evt:t}),this.nativeDraggable&&j(document,"dragover",mt);var n=this.options;!e&&Q(Ce,n.dragClass,!1),Q(Ce,n.ghostClass,!0),bt.active=this,e&&this._appendGhost(),Ee({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(We){this._lastX=We.clientX,this._lastY=We.clientY,ft();var e=document.elementFromPoint(We.clientX,We.clientY),t=e;while(e&&e.shadowRoot){if(e=e.shadowRoot.elementFromPoint(We.clientX,We.clientY),e===t)break;t=e}if(Ce.parentNode[ge]._isOutsideThisEl(e),t)do{if(t[ge]){var n=void 0;if(n=t[ge]._onDragOver({clientX:We.clientX,clientY:We.clientY,target:e,rootEl:t}),n&&!this.options.dragoverBubble)break}e=t}while(t=V(t));gt()}},_onTouchMove:function(e){if(Be){var t=this.options,n=t.fallbackTolerance,o=t.fallbackOffset,i=e.touches?e.touches[0]:e,a=xe&&K(xe,!0),r=xe&&a&&a.a,l=xe&&a&&a.d,s=rt&&qe&&ae(qe),c=(i.clientX-Be.clientX+o.x)/(r||1)+(s?s[0]-nt[0]:0)/(r||1),d=(i.clientY-Be.clientY+o.y)/(l||1)+(s?s[1]-nt[1]:0)/(l||1);if(!bt.active&&!Ke){if(n&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<n)return;this._onDragStart(e,!0)}if(xe){a?(a.e+=c-(je||0),a.f+=d-(He||0)):a={a:1,b:0,c:0,d:1,e:c,f:d};var u="matrix(".concat(a.a,",").concat(a.b,",").concat(a.c,",").concat(a.d,",").concat(a.e,",").concat(a.f,")");q(xe,"webkitTransform",u),q(xe,"mozTransform",u),q(xe,"msTransform",u),q(xe,"transform",u),je=c,He=d,We=i}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!xe){var e=this.options.fallbackOnBody?document.body:Fe,t=ee(Ce,!0,rt,!0,e),n=this.options;if(rt){qe=e;while("static"===q(qe,"position")&&"none"===q(qe,"transform")&&qe!==document)qe=qe.parentNode;qe!==document.body&&qe!==document.documentElement?(qe===document&&(qe=J()),t.top+=qe.scrollTop,t.left+=qe.scrollLeft):qe=J(),nt=ae(qe)}xe=Ce.cloneNode(!0),Q(xe,n.ghostClass,!1),Q(xe,n.fallbackClass,!0),Q(xe,n.dragClass,!0),q(xe,"transition",""),q(xe,"transform",""),q(xe,"box-sizing","border-box"),q(xe,"margin",0),q(xe,"top",t.top),q(xe,"left",t.left),q(xe,"width",t.width),q(xe,"height",t.height),q(xe,"opacity","0.8"),q(xe,"position",rt?"absolute":"fixed"),q(xe,"zIndex","100000"),q(xe,"pointerEvents","none"),bt.ghost=xe,e.appendChild(xe),q(xe,"transform-origin",ze/parseInt(xe.style.width)*100+"% "+Ve/parseInt(xe.style.height)*100+"%")}},_onDragStart:function(e,t){var n=this,o=e.dataTransfer,i=n.options;De("dragStart",this,{evt:e}),bt.eventCanceled?this._onDrop():(De("setupClone",this),bt.eventCanceled||(Oe=pe(Ce),Oe.removeAttribute("id"),Oe.draggable=!1,Oe.style["will-change"]="",this._hideClone(),Q(Oe,this.options.chosenClass,!1),bt.clone=Oe),n.cloneId=Ft((function(){De("clone",n),bt.eventCanceled||(n.options.removeCloneOnHide||Fe.insertBefore(Oe,Ce),n._hideClone(),Ee({sortable:n,name:"clone"}))})),!t&&Q(Ce,i.dragClass,!0),t?(Ze=!0,n._loopId=setInterval(n._emulateDragOver,50)):(H(document,"mouseup",n._onDrop),H(document,"touchend",n._onDrop),H(document,"touchcancel",n._onDrop),o&&(o.effectAllowed="move",i.setData&&i.setData.call(n,o,Ce)),j(document,"drop",n),q(Ce,"transform","translateZ(0)")),Ke=!0,n._dragStartId=Ft(n._dragStarted.bind(n,t,e)),j(document,"selectstart",n),$e=!0,window.getSelection().removeAllRanges(),L&&q(document.body,"user-select","none"))},_onDragOver:function(e){var t,n,o,i,a=this.el,r=e.target,l=this.options,s=l.group,c=bt.active,d=Le===s,u=l.sort,h=Ye||c,p=this,f=!1;if(!ot){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),r=$(r,l.draggable,a,!0),I("dragOver"),bt.eventCanceled)return f;if(Ce.contains(e.target)||r.animated&&r.animatingX&&r.animatingY||p._ignoreWhileAnimating===r)return O(!1);if(Ze=!1,c&&!l.disabled&&(d?u||(o=Te!==Fe):Ye===this||(this.lastPutMode=Le.checkPull(this,c,Ce,e))&&s.checkPut(this,c,Ce,e))){if(i="vertical"===this._getDirection(e,r),t=ee(Ce),I("dragOverValid"),bt.eventCanceled)return f;if(o)return Te=Fe,A(),this._hideClone(),I("revert"),bt.eventCanceled||(Ie?Fe.insertBefore(Ce,Ie):Fe.appendChild(Ce)),O(!0);var g=oe(a,l.draggable);if(!g||Dt(e,i,this)&&!g.animated){if(g===Ce)return O(!1);if(g&&a===e.target&&(r=g),r&&(n=ee(r)),!1!==wt(Fe,a,Ce,t,r,n,e,!!r))return A(),g&&g.nextSibling?a.insertBefore(Ce,g.nextSibling):a.appendChild(Ce),Te=a,M(),O(!0)}else if(g&&kt(e,i,this)){var v=ne(a,0,l,!0);if(v===Ce)return O(!1);if(r=v,n=ee(r),!1!==wt(Fe,a,Ce,t,r,n,e,!1))return A(),a.insertBefore(Ce,v),Te=a,M(),O(!0)}else if(r.parentNode===a){n=ee(r);var m,b,y=0,w=Ce.parentNode!==a,_=!ut(Ce.animated&&Ce.toRect||t,r.animated&&r.toRect||n,i),S=i?"top":"left",k=te(r,"top","top")||te(Ce,"top","top"),D=k?k.scrollTop:void 0;if(Ue!==r&&(m=n[S],et=!1,tt=!_&&l.invertSwap||w),y=Et(e,r,n,i,_?1:l.swapThreshold,null==l.invertedSwapThreshold?l.swapThreshold:l.invertedSwapThreshold,tt,Ue===r),0!==y){var E=ie(Ce);do{E-=y,b=Te.children[E]}while(b&&("none"===q(b,"display")||b===xe))}if(0===y||b===r)return O(!1);Ue=r,Ge=y;var C=r.nextElementSibling,x=!1;x=1===y;var F=wt(Fe,a,Ce,t,r,n,e,x);if(!1!==F)return 1!==F&&-1!==F||(x=1===F),ot=!0,setTimeout(St,30),A(),x&&!C?a.appendChild(Ce):r.parentNode.insertBefore(Ce,x?C:r),k&&he(k,0,D-k.scrollTop),Te=Ce.parentNode,void 0===m||tt||(Qe=Math.abs(m-ee(r)[S])),M(),O(!0)}if(a.contains(Ce))return O(!1)}return!1}function I(l,s){De(l,p,T({evt:e,isOwner:d,axis:i?"vertical":"horizontal",revert:o,dragRect:t,targetRect:n,canSort:u,fromSortable:h,target:r,completed:O,onMove:function(n,o){return wt(Fe,a,Ce,t,n,ee(n),e,o)},changed:M},s))}function A(){I("dragOverAnimationCapture"),p.captureAnimationState(),p!==h&&h.captureAnimationState()}function O(t){return I("dragOverCompleted",{insertion:t}),t&&(d?c._hideClone():c._showClone(p),p!==h&&(Q(Ce,Ye?Ye.options.ghostClass:c.options.ghostClass,!1),Q(Ce,l.ghostClass,!0)),Ye!==p&&p!==bt.active?Ye=p:p===bt.active&&Ye&&(Ye=null),h===p&&(p._ignoreWhileAnimating=r),p.animateAll((function(){I("dragOverAnimationComplete"),p._ignoreWhileAnimating=null})),p!==h&&(h.animateAll(),h._ignoreWhileAnimating=null)),(r===Ce&&!Ce.animated||r===a&&!r.animated)&&(Ue=null),l.dragoverBubble||e.rootEl||r===document||(Ce.parentNode[ge]._isOutsideThisEl(e.target),!t&&vt(e)),!l.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),f=!0}function M(){Pe=ie(Ce),Xe=ie(Ce,l.draggable),Ee({sortable:p,name:"change",toEl:a,newIndex:Pe,newDraggableIndex:Xe,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){H(document,"mousemove",this._onTouchMove),H(document,"touchmove",this._onTouchMove),H(document,"pointermove",this._onTouchMove),H(document,"dragover",vt),H(document,"mousemove",vt),H(document,"touchmove",vt)},_offUpEvents:function(){var e=this.el.ownerDocument;H(e,"mouseup",this._onDrop),H(e,"touchend",this._onDrop),H(e,"pointerup",this._onDrop),H(e,"pointercancel",this._onDrop),H(e,"touchcancel",this._onDrop),H(document,"selectstart",this)},_onDrop:function(e){var t=this.el,n=this.options;Pe=ie(Ce),Xe=ie(Ce,n.draggable),De("drop",this,{evt:e}),Te=Ce&&Ce.parentNode,Pe=ie(Ce),Xe=ie(Ce,n.draggable),bt.eventCanceled||(Ke=!1,tt=!1,et=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),It(this.cloneId),It(this._dragStartId),this.nativeDraggable&&(H(document,"drop",this),H(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),L&&q(document.body,"user-select",""),q(Ce,"transform",""),e&&($e&&(e.cancelable&&e.preventDefault(),!n.dropBubble&&e.stopPropagation()),xe&&xe.parentNode&&xe.parentNode.removeChild(xe),(Fe===Te||Ye&&"clone"!==Ye.lastPutMode)&&Oe&&Oe.parentNode&&Oe.parentNode.removeChild(Oe),Ce&&(this.nativeDraggable&&H(Ce,"dragend",this),_t(Ce),Ce.style["will-change"]="",$e&&!Ke&&Q(Ce,Ye?Ye.options.ghostClass:this.options.ghostClass,!1),Q(Ce,this.options.chosenClass,!1),Ee({sortable:this,name:"unchoose",toEl:Te,newIndex:null,newDraggableIndex:null,originalEvent:e}),Fe!==Te?(Pe>=0&&(Ee({rootEl:Te,name:"add",toEl:Te,fromEl:Fe,originalEvent:e}),Ee({sortable:this,name:"remove",toEl:Te,originalEvent:e}),Ee({rootEl:Te,name:"sort",toEl:Te,fromEl:Fe,originalEvent:e}),Ee({sortable:this,name:"sort",toEl:Te,originalEvent:e})),Ye&&Ye.save()):Pe!==Ne&&Pe>=0&&(Ee({sortable:this,name:"update",toEl:Te,originalEvent:e}),Ee({sortable:this,name:"sort",toEl:Te,originalEvent:e})),bt.active&&(null!=Pe&&-1!==Pe||(Pe=Ne,Xe=Re),Ee({sortable:this,name:"end",toEl:Te,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){De("nulling",this),Fe=Ce=Te=xe=Ie=Oe=Ae=Me=Be=We=$e=Pe=Xe=Ne=Re=Ue=Ge=Ye=Le=bt.dragged=bt.ghost=bt.clone=bt.active=null,it.forEach((function(e){e.checked=!0})),it.length=je=He=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":Ce&&(this._onDragOver(e),yt(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e,t=[],n=this.el.children,o=0,i=n.length,a=this.options;o<i;o++)e=n[o],$(e,a.draggable,this.el,!1)&&t.push(e.getAttribute(a.dataIdAttr)||Tt(e));return t},sort:function(e,t){var n={},o=this.el;this.toArray().forEach((function(e,t){var i=o.children[t];$(i,this.options.draggable,o,!1)&&(n[e]=i)}),this),t&&this.captureAnimationState(),e.forEach((function(e){n[e]&&(o.removeChild(n[e]),o.appendChild(n[e]))})),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return $(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var n=this.options;if(void 0===t)return n[e];var o=_e.modifyOption(this,e,t);n[e]="undefined"!==typeof o?o:t,"group"===e&&pt(n)},destroy:function(){De("destroy",this);var e=this.el;e[ge]=null,H(e,"mousedown",this._onTapStart),H(e,"touchstart",this._onTapStart),H(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(H(e,"dragover",this),H(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),(function(e){e.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),Je.splice(Je.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Me){if(De("hideClone",this),bt.eventCanceled)return;q(Oe,"display","none"),this.options.removeCloneOnHide&&Oe.parentNode&&Oe.parentNode.removeChild(Oe),Me=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(Me){if(De("showClone",this),bt.eventCanceled)return;Ce.parentNode!=Fe||this.options.group.revertClone?Ie?Fe.insertBefore(Oe,Ie):Fe.appendChild(Oe):Fe.insertBefore(Oe,Ce),this.options.group.revertClone&&this.animate(Ce,Oe),q(Oe,"display",""),Me=!1}}else this._hideClone()}},at&&j(document,"touchmove",(function(e){(bt.active||Ke)&&e.cancelable&&e.preventDefault()})),bt.utils={on:j,off:H,css:q,find:Z,is:function(e,t){return!!$(e,t,e,!1)},extend:se,throttle:de,closest:$,toggleClass:Q,clone:pe,index:ie,nextTick:Ft,cancelNextTick:It,detectDirection:dt,getChild:ne,expando:ge},bt.get=function(e){return e[ge]},bt.mount=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t[0].constructor===Array&&(t=t[0]),t.forEach((function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(bt.utils=T(T({},bt.utils),e.utils)),_e.mount(e)}))},bt.create=function(e,t){return new bt(e,t)},bt.version=M;var At,Ot,Mt,Nt,Pt,Rt,Xt=[],Lt=!1;function Yt(){function e(){for(var e in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"===typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?j(document,"dragover",this._handleAutoScroll):this.options.supportPointer?j(document,"pointermove",this._handleFallbackAutoScroll):t.touches?j(document,"touchmove",this._handleFallbackAutoScroll):j(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?H(document,"dragover",this._handleAutoScroll):(H(document,"pointermove",this._handleFallbackAutoScroll),H(document,"touchmove",this._handleFallbackAutoScroll),H(document,"mousemove",this._handleFallbackAutoScroll)),Wt(),Bt(),ue()},nulling:function(){Pt=Ot=At=Lt=Rt=Mt=Nt=null,Xt.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,t){var n=this,o=(e.touches?e.touches[0]:e).clientX,i=(e.touches?e.touches[0]:e).clientY,a=document.elementFromPoint(o,i);if(Pt=e,t||this.options.forceAutoScrollFallback||R||P||L){jt(e,this.options,a,t);var r=le(a,!0);!Lt||Rt&&o===Mt&&i===Nt||(Rt&&Wt(),Rt=setInterval((function(){var a=le(document.elementFromPoint(o,i),!0);a!==r&&(r=a,Bt()),jt(e,n.options,a,t)}),10),Mt=o,Nt=i)}else{if(!this.options.bubbleScroll||le(a,!0)===J())return void Bt();jt(e,this.options,le(a,!1),!1)}}},I(e,{pluginName:"scroll",initializeByDefault:!0})}function Bt(){Xt.forEach((function(e){clearInterval(e.pid)})),Xt=[]}function Wt(){clearInterval(Rt)}var jt=de((function(e,t,n,o){if(t.scroll){var i,a=(e.touches?e.touches[0]:e).clientX,r=(e.touches?e.touches[0]:e).clientY,l=t.scrollSensitivity,s=t.scrollSpeed,c=J(),d=!1;Ot!==n&&(Ot=n,Bt(),At=t.scroll,i=t.scrollFn,!0===At&&(At=le(n,!0)));var u=0,h=At;do{var p=h,f=ee(p),g=f.top,v=f.bottom,m=f.left,b=f.right,y=f.width,w=f.height,_=void 0,S=void 0,k=p.scrollWidth,D=p.scrollHeight,E=q(p),C=p.scrollLeft,T=p.scrollTop;p===c?(_=y<k&&("auto"===E.overflowX||"scroll"===E.overflowX||"visible"===E.overflowX),S=w<D&&("auto"===E.overflowY||"scroll"===E.overflowY||"visible"===E.overflowY)):(_=y<k&&("auto"===E.overflowX||"scroll"===E.overflowX),S=w<D&&("auto"===E.overflowY||"scroll"===E.overflowY));var x=_&&(Math.abs(b-a)<=l&&C+y<k)-(Math.abs(m-a)<=l&&!!C),F=S&&(Math.abs(v-r)<=l&&T+w<D)-(Math.abs(g-r)<=l&&!!T);if(!Xt[u])for(var I=0;I<=u;I++)Xt[I]||(Xt[I]={});Xt[u].vx==x&&Xt[u].vy==F&&Xt[u].el===p||(Xt[u].el=p,Xt[u].vx=x,Xt[u].vy=F,clearInterval(Xt[u].pid),0==x&&0==F||(d=!0,Xt[u].pid=setInterval(function(){o&&0===this.layer&&bt.active._onTouchMove(Pt);var t=Xt[this.layer].vy?Xt[this.layer].vy*s:0,n=Xt[this.layer].vx?Xt[this.layer].vx*s:0;"function"===typeof i&&"continue"!==i.call(bt.dragged.parentNode[ge],n,t,e,Pt,Xt[this.layer].el)||he(Xt[this.layer].el,n,t)}.bind({layer:u}),24))),u++}while(t.bubbleScroll&&h!==c&&(h=le(h,!1)));Lt=d}}),30),Ht=function(e){var t=e.originalEvent,n=e.putSortable,o=e.dragEl,i=e.activeSortable,a=e.dispatchSortableEvent,r=e.hideGhostForTarget,l=e.unhideGhostForTarget;if(t){var s=n||i;r();var c=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,d=document.elementFromPoint(c.clientX,c.clientY);l(),s&&!s.el.contains(d)&&(a("spill"),this.onSpill({dragEl:o,putSortable:n}))}};function zt(){}function Vt(){}zt.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,n=e.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var o=ne(this.sortable.el,this.startIndex,this.options);o?this.sortable.el.insertBefore(t,o):this.sortable.el.appendChild(t),this.sortable.animateAll(),n&&n.animateAll()},drop:Ht},I(zt,{pluginName:"revertOnSpill"}),Vt.prototype={onSpill:function(e){var t=e.dragEl,n=e.putSortable,o=n||this.sortable;o.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),o.animateAll()},drop:Ht},I(Vt,{pluginName:"removeOnSpill"});bt.mount(new Yt),bt.mount(Vt,zt);var $t=bt,Ut=n(3999),Gt=n(5338),Qt={components:{EditCase:Ut.A,caseResult:Gt.A},data(){return{active:"1",sceneInfo:null,steps:null,addStepDlg:!1,activeTab:"internal",addTreeProps:{children:"steps",label:"name"},editStepDlg:!1,editCase:null,runSceneResult:null,ResultDlg:!1,loading:!1,loadingSteps:!1,addingScene:!1,saving:!1,running:!1,deleting:!1,addingSteps:!1,sortableInstance:null,searchText:""}},computed:{...(0,S.aH)(["pro","testScenes","envId"]),...(0,S.L8)(["inters1","inters2"]),hasSelectedEnv(){return!!this.envId}},methods:{...(0,S.i0)(["getAllScene","getAllInterFaces"]),async addScene(){try{this.addingScene=!0;const e={name:"New Scene",project:this.pro.id},t=await this.$api.createTestScene(e);201===t.status&&(k.nk.success("添加成功"),await this.getAllScene())}catch(e){console.error("添加场景失败:",e),k.nk.error("添加场景失败")}finally{this.addingScene=!1}},async handleSceneClick(e){if(!this.loading)try{this.loading=!0,await this.getSceneData(e),this.active=e.id.toString()}catch(t){console.error("获取场景数据失败:",t),k.nk.error("获取场景数据失败")}finally{this.loading=!1}},async getSceneData(e){try{this.loadingSteps=!0,this.sceneInfo={...e};const t=await this.$api.getSceneDatas(e.id);if(200!==t.status)throw new Error(`请求失败，状态码: ${t.status}`);this.steps=t.data||null,this.$nextTick(this.initSortable)}catch(t){console.error("获取场景步骤失败:",t),this.steps=null,k.nk.error("获取场景步骤失败")}finally{this.loadingSteps=!1}},initSortable(){try{const e=document.querySelector(".el-table__body-wrapper tbody");if(!e)throw new Error("表格元素未找到");this.sortableInstance&&this.sortableInstance.destroy(),this.sortableInstance=new $t(e,{animation:150,ghostClass:"sortable-ghost",onEnd:async e=>{const t=this.steps.splice(e.oldIndex,1)[0];this.steps.splice(e.newIndex,0,t),await this.updateSceneOrder()}})}catch(e){console.error("初始化拖拽失败:",e),setTimeout(this.initSortable,300)}},async updateSceneOrder(){try{this.steps.forEach(((e,t)=>{e.sort=t+1}));const e=await this.$api.updateSceneDataOrder(this.steps);if(200!==e.status)throw new Error("更新顺序失败");k.nk.success("调整排序成功")}catch(e){console.error("更新步骤顺序失败:",e),k.nk.error("调整排序失败"),await this.getSceneData(this.sceneInfo)}},async saveScene(){try{this.saving=!0;const e=await this.$api.updateTestScene(this.sceneInfo.id,this.sceneInfo);if(200!==e.status)throw new Error("保存失败");k.nk.success("保存成功"),await this.getAllScene()}catch(e){console.error("保存场景失败:",e),k.nk.error("保存失败")}finally{this.saving=!1}},async deleteScene(){try{await D.s.confirm("确定要删除该测试场景吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),this.deleting=!0;const e=await this.$api.delTestScene(this.sceneInfo.id);204===e.status&&(k.nk.success("删除成功"),await this.getAllScene(),this.testScenes.length>0?await this.handleSceneClick(this.testScenes[0]):(this.sceneInfo=null,this.steps=null))}catch(e){"cancel"!==e&&(console.error("删除场景失败:",e),k.nk.error("删除失败"))}finally{this.deleting=!1}},async runScene(){try{this.running=!0;const e={env:this.envId,scene:this.sceneInfo.id};k.nk.success("开始运行!");const t=await this.$api.runTest(e);if(200!==t.status)throw new Error("运行失败");this.runSceneResult=t.data,this.ResultDlg=!0}catch(e){console.error("运行场景失败:",e),k.nk.error("运行场景失败")}finally{this.running=!1}},clickEditStep(e){this.editCase=e,this.editStepDlg=!0},handleCaseSaved(){this.editStepDlg=!1,this.getSceneData(this.sceneInfo)},async clickDelete(e){try{await D.s.confirm("确定要删除该步骤吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const t=await this.$api.delSceneData(e);204===t.status&&(k.nk.success("删除成功"),await this.getSceneData(this.sceneInfo))}catch(t){"cancel"!==t&&(console.error("删除步骤失败:",t),k.nk.error("删除失败"))}},async confirmAddToScene(){try{this.addingSteps=!0;const e=this.getCheckedCases();if(0===e.length)return void k.nk.warning("请先选择要添加的用例");await this.addToScene(e),E.df.success({title:"成功",message:"用例添加成功",duration:2e3}),this.addStepDlg=!1}catch(e){console.error("添加步骤失败:",e),E.df.error({title:"失败",message:"添加用例失败",duration:2e3})}finally{this.addingSteps=!1}},getCheckedCases(){const e=this.$refs.treeM1?.getCheckedNodes()||[],t=this.$refs.treeM2?.getCheckedNodes()||[];return[...e,...t].filter((e=>e.title))},async addToScene(e){const t=this.steps.length,n=e.map(((e,n)=>this.$api.addSceneData({step:e.id,scene:this.sceneInfo.id,sort:t+n+1})));await Promise.all(n),await this.getSceneData(this.sceneInfo),await this.getAllInterFaces()},filterNode(e,t){return!e||(t.name.includes(e)||t.title&&t.title.includes(e))},handleDrawerClose(e){e()},handleEditDrawerClose(e){this.editCase?.hasChanges?D.s.confirm("还有未保存的修改，确定要关闭吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{e()})).catch((()=>{})):e()},handleAddStepClose(e){const t=this.getCheckedCases().length>0;t?D.s.confirm("已选择用例但未添加，确定要关闭吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{e()})).catch((()=>{})):e()}},async created(){try{this.loading=!0,await this.getAllScene(),this.testScenes.length>0&&(this.loading=!1,await this.handleSceneClick(this.testScenes[0]),this.loading=!0)}catch(e){console.error("初始化失败:",e),k.nk.error("初始化测试场景失败")}finally{this.loading=!1}},beforeUnmount(){this.sortableInstance&&this.sortableInstance.destroy()}},qt=n(1241);const Kt=(0,qt.A)(Qt,[["render",_],["__scopeId","data-v-6ee69edf"]]);var Zt=Kt}}]);
//# sourceMappingURL=group-8.b9584b8d.js.map